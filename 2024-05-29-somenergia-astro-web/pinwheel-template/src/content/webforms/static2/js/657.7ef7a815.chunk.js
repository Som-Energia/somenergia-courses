"use strict";(self.webpackChunkwebforms_ui=self.webpackChunkwebforms_ui||[]).push([[657],{4884:function(n,e,t){t(2791);e.Z=t.p+"static/media/cuca-marejada.961d3322d12dc497cbf787a31e3caf17.svg"},6657:function(n,e,t){t.r(e),t.d(e,{default:function(){return mn}});var r=t(4165),a=t(5861),i=t(9439),c=t(2791),s=t(4944),o=t(3168),l=t(7689),d=t(9299),u=t(8596),T=t(1288),N=t(8302),E=t(184),_=(0,u.Z)({h2:{background:"#96b633",color:"#fff",textTransform:"uppercase",fontSize:"14px",margin:"10px 0 4px 0",display:"flex",justifyContent:"space-between",alignItems:"center"}});var x=function(n){var e=n.text,t=n.children,r=_();return(0,E.jsxs)(T.Z,{container:!0,className:r.h2,children:[(0,E.jsx)(N.Z,{component:"h2",children:e}),t]})},m=t(1413),p=t(3433),f=t(7892),g=t.n(f),h=t(5936),I=t(6556),S=t(6593),A=t(7631),j=t(8583),Z=t(9773),C=t(3486),v=t(9526),b=(0,u.Z)({table:{minWidth:650},tableHeader:{background:"#e6e6e6"}}),O=(0,h.Z)((function(n){return{body:{fontSize:14}}}))(A.Z);function R(n){var e=n.columns,t=n.rows,r=n.children,a=n.id,i=b();return(0,E.jsx)(j.Z,{component:v.Z,children:(0,E.jsxs)(I.Z,{id:a,className:i.table,"aria-label":"simple table",children:[(0,E.jsx)(Z.Z,{className:i.tableHeader,children:(0,E.jsx)(C.Z,{children:e.map((function(n){return(0,E.jsx)(O,{children:n},n)}))})}),r||(0,E.jsx)(S.Z,{children:t.map((function(n){return(0,E.jsx)(C.Z,{id:n.name,children:Object.keys(n).map((function(e,t){return(0,E.jsx)(O,{children:n[e]},n[e]+t)}))},n.name)}))})]})})}var y=t(9234),L=t(4265),M=t(1416),k=t(7407),D=t(7025),G=t(2826),B=t(6513),w=t(269),V=t(4026),F=t(5159),P=t(4324),H=(0,u.Z)({customBackdrop:{backgroundColor:"rgba(150, 182, 51, 0.5)"},modal:function(n){return{position:"absolute",top:0,backgroundColor:n?"white":"transparent",boxShadow:n?"0px 11px 15px -7px rgba(0,0,0,0.2),0px 24px 38px 3px rgba(0,0,0,0.14),0px 9px 46px 8px rgba(0,0,0,0.12)":"none"}}});var U=function(n){var e=n.children,t=n.withBackground,r=n.blockHandleClose,a=H(t),i=c.useContext(G.Z).setContent;return(0,E.jsx)(P.Z,{onClose:function(){r||i(void 0)},open:void 0!==e,PaperProps:{className:a.modal},BackdropProps:{className:a.customBackdrop},id:"custom-dialog",children:e})};function Y(n){var e=n.title,t=n.text,r=n.acceptFunction,a=n.cancelFunction,i=(0,o.$)().t;return(0,E.jsxs)(U,{"data-testid":"simple-dialog",withBackground:!0,children:[(0,E.jsx)(F.Z,{id:"simple-dialog-title",children:e}),(0,E.jsx)(V.Z,{children:t}),(0,E.jsxs)(w.Z,{children:[a?(0,E.jsx)(B.Z,{"data-testid":"simple-dialog-button-cancel",onClick:function(){return a()},color:"primary",children:i("GENERATION_ADD_CONTRACT_LIST_CANCEL")}):null,r?(0,E.jsx)(B.Z,{"data-testid":"simple-dialog-button-accept",onClick:function(){return r()},color:"primary",autoFocus:!0,children:i("GENERATION_ADD_CONTRACT_LIST_ACCEPT")}):null]})]})}var z=t(1422),X=t(2130);function $(n,e,t,r,a,i,c){return{id:n,contract:e,contractAddress:t,contractTariff:r,priority:a,contractLastInvoiced:i,annualUseKwh:c}}var K=(0,u.Z)({dragger:{display:"flex",alignItems:"center",gap:15}}),W=(0,h.Z)((function(){return{body:{fontSize:14}}}))(A.Z);function J(n){var e=n.data,t=K(),l=e.map((function(n){return $.apply(void 0,(0,p.Z)(Object.values(n)))})),u=(0,o.$)().t,T=(0,c.useContext)(s.Z),_=T.getPriority,x=T.setEditingPriority,f=T.changeAssigmentPriority,h=T.getAssingments,I=T.getContractsToAssign,A=(0,c.useState)(!1),j=(0,i.Z)(A,2),Z=j[0],v=j[1],b=(0,c.useContext)(G.Z).setContent,O=(0,c.useMemo)((function(){return[u("GENERATION_ASSIGNMENTS_TABLE_TTILE_PRIORITY"),u("GENERATION_ASSIGNMENTS_TABLE_TTILE_N_CONTRACT"),u("ADDRESS"),u("GENERATION_ASSIGNMENTS_TABLE_TTILE_LAST_DATE"),u("GENERATION_ASSIGNMENTS_TABLE_TITLE_ANNUAL_USE_KWH"),""]}),[u]),B=(0,c.useCallback)((function(n,e){x(!0),f(l[n],l[e])}),[f,l,x]),w=function(){var n=(0,a.Z)((0,r.Z)().mark((function n(e){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,v(!0),b((0,E.jsx)(U,{withBackground:!1,blockHandleClose:!0,children:(0,E.jsx)(z.Z,{})})),n.next=5,(0,d.Jp)(e);case 5:return n.next=7,I();case 7:v(!1),h(),n.next=15;break;case 11:n.prev=11,n.t0=n.catch(0),console.error(n.t0),v(!1);case 15:b(void 0);case 16:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e){return n.apply(this,arguments)}}();return(0,E.jsx)(y.Z5,{onDragEnd:function(n){B(n.source.index,n.destination.index)},onBeforeDragStart:function(n){var e=document.getElementsByClassName(n.draggableId+"styled-cell");Object.values(e).forEach((function(n){var e=window.getComputedStyle(n);n.style.width=e.width}))},children:(0,E.jsx)(y.bK,{droppableId:"assignments",children:function(n){return(0,E.jsx)(R,{id:"assignment-table",columns:O,children:(0,E.jsxs)(S.Z,(0,m.Z)((0,m.Z)({},n.droppableProps),{},{ref:n.innerRef,children:[l.map((function(n,e){return(0,E.jsx)(y._l,{draggableId:n.contract,index:e,children:function(e,r){return(0,E.jsxs)(C.Z,(0,m.Z)((0,m.Z)({},e.draggableProps),{},{ref:e.innerRef,id:n.contract,children:[(0,E.jsx)(W,(0,m.Z)((0,m.Z)({className:n.contract+"styled-cell",size:"small"},e.dragHandleProps),{},{children:(0,E.jsxs)(L.Z,{className:t.dragger,children:[(0,E.jsx)(M.Z,{}),_(n.priority).value]})})),(0,E.jsx)(W,{className:n.contract+"styled-cell",children:n.contract}),(0,E.jsx)(W,{className:n.contract+"styled-cell",children:n.contractAddress}),(0,E.jsx)(W,{className:n.contract+"styled-cell",children:g()(n.contractLastInvoiced.replaceAll('"',"")).format("DD/MM/YYYY")}),(0,E.jsx)(W,{className:n.contract+"styled-cell",children:Number(n.annualUseKwh).toLocaleString("es-ES",{minimumFractionDigits:2})}),(0,E.jsx)(W,{className:n.contract+"styled-cell",children:(0,E.jsx)(D.Z,{id:"delete-button-".concat(n.id),disabled:Z,onClick:function(){return b((0,E.jsx)(Y,{title:u("GENERATION_ASSIGNMENTS_CONFIRM_TITLE"),text:(0,E.jsx)(X.Z,{severity:"warning",children:(0,E.jsx)(N.Z,{dangerouslySetInnerHTML:{__html:u("GENERATION_REMOVE_ASSIGNMENTS_ALERT_MSG")}})}),acceptFunction:function(){return w(n.id)},cancelFunction:function(){return b(void 0)}}))},children:(0,E.jsx)(k.Z,{})})})]}))}},n.contract)})),n.placeholder]}))})}})})}function q(n,e,t,r,a,i,c){return{name:n,nominal_amount:Number(e).toLocaleString("es-ES")+"\u20ac",nshares:t,purchase_date:r?g()(r.replaceAll('"',"")).format("DD/MM/YYYY"):"--",first_effective_date:a?g()(a.replaceAll('"',"")).format("DD/MM/YYYY"):"--",amortized_amount:Number(i).toLocaleString("es-ES")+"\u20ac",last_effective_date:c?g()(c.replaceAll('"',"")).format("DD/MM/YYYY"):"--"}}function Q(n){var e=n.data,t=(0,o.$)().t,r=(0,c.useMemo)((function(){return e.map((function(n){return q.apply(void 0,(0,p.Z)(Object.values(n)))}))}),[e]),a=(0,c.useMemo)((function(){return[t("GENERATION_INVESTMENTS_TABLE_TTILE_N_INVESTMENT"),t("GENERATION_INVESTMENTS_TABLE_TTILE_INVESTED_AMOUNT"),t("GENERATION_INVESTMENTS_TABLE_TTILE_ENERGY_ACTIONS"),t("GENERATION_INVESTMENTS_TABLE_TITLE_PURCHASE_DATE "),t("GENERATION_INVESTMENTS_TABLE_TITLE_ACTIVATION_DATE "),t("GENERATION_INVESTMENTS_TABLE_TITLE_AMORTIZED_AMOUNT "),t("GENERATION_INVESTMENTS_TABLE_TITLE_END_DATE ")]}),[t]);return(0,E.jsx)(R,{id:"investment-table",columns:a,rows:r})}var nn=t(272),en=t(14),tn=t(4884),rn=(0,u.Z)((function(n){return{container:{paddingTop:0,display:"flex",flexDirection:"column",alignItems:"center"},message:{marginTop:n.spacing(2),fontWeight:"400",fontSize:"1rem",lineHeight:"1.75",textAlign:"center",color:"#6f6262","& a":{color:"#fe6444 !important"}},logo:{width:"220px",margin:n.spacing(2)},title:{textAlign:"center",fontSize:"1.15rem"},error:{width:n.spacing(6),height:n.spacing(6),color:"#fe6444",backgroundColor:"transparent",border:"2px solid #fe6444",marginBottom:n.spacing(3)}}}));var an=function(n){var e=(0,l.UO)().language,t=(0,o.$)(),r=t.t,a=t.i18n,i=rn();return(0,c.useEffect)((function(){a.changeLanguage(e)}),[e,a]),(0,E.jsx)(E.Fragment,{children:(0,E.jsxs)("div",{className:i.container,children:[(0,E.jsx)(nn.Z,{className:i.error,children:(0,E.jsx)(en.Z,{fontSize:"large"})}),(0,E.jsx)(N.Z,{className:i.title,variant:"h6",children:r("FAILURE_TEXT")}),(0,E.jsx)(N.Z,{className:i.message,variant:"body1",dangerouslySetInnerHTML:{__html:r("INDEXED_UNEXPECTED_ERROR_TXT",{url:r("CONTACT_HELP_URL")})}}),(0,E.jsx)(L.Z,{mt:3,mb:1,children:(0,E.jsx)("img",{className:i.logo,alt:"Cuca KO de Som Energia",src:tn.Z})})]})})},cn=t(9329),sn=t(3459),on=t(2067),ln=t(8096),dn=t(1969),un=t(159),Tn=t(5247),Nn=(0,u.Z)((function(n){return{grid:{display:"flex",justifyContent:"center",padding:"15px",flexDirection:"column",gap:"1rem"},titleContainer:{display:"flex",justifyContent:"center"},title:{fontSize:"16px"},groupButton:{display:"flex",justifyContent:"space-between"}}}));function En(n){var e=n.data,t=n.title,r=n.acceptFunction,a=n.acceptButtonText,s=n.cancelFunction,l=n.cancelButtonText,d=Nn(),u=(0,c.useState)([]),_=(0,i.Z)(u,2),x=_[0],m=_[1],f=(0,o.$)().t,g=function(n){var e=n.data;return(0,E.jsxs)(T.Z,{container:!0,className:d.grid,children:[(0,E.jsx)(T.Z,{container:!0,item:!0,className:d.titleContainer,children:(0,E.jsx)(N.Z,{className:d.title,variant:"h6",children:t})}),(0,E.jsx)(T.Z,{container:!0,item:!0,children:(0,E.jsx)(on.Z,{className:d.root,children:e.map((function(n){return(0,E.jsxs)(ln.Z,{role:void 0,dense:!0,button:!0,onClick:function(){return function(n){var e=x.indexOf(n),t=(0,p.Z)(x);-1===e?t.push(n):t.splice(e,1),m(t)}(n.id)},children:[(0,E.jsx)(dn.Z,{children:(0,E.jsx)(Tn.Z,{"data-testid":"checkbox-"+n.id,edge:"start",checked:-1!==x.indexOf(n.id),tabIndex:-1,disableRipple:!0})}),(0,E.jsx)(un.Z,{id:n.id,primary:n.primary,secondary:n.secondary})]},n.id)}))})}),(0,E.jsx)(T.Z,{children:(0,E.jsx)(N.Z,{variant:"body2",dangerouslySetInnerHTML:{__html:f("GENERATION_ADD_ASSIGNMENTS_INFO_MSG")}})}),(0,E.jsxs)(T.Z,{item:!0,container:!0,className:d.groupButton,children:[r?(0,E.jsx)(B.Z,{color:"primary","data-testid":"list-accept-button",disabled:0===x.length,onClick:function(){return r(x)},children:a}):null,s?(0,E.jsx)(B.Z,{color:"primary","data-testid":"list-cancel-button",onClick:s,children:l}):null]})]})};return(0,E.jsx)("div",{className:d.root,children:(0,E.jsx)(g,{data:e})})}var _n=(0,u.Z)({footer:{padding:"10px"},button:{background:"#96b633",color:"#fff"},altButton:{background:"#8E8C8C",color:"#fff"},buttons:{gap:"5px",justifyContent:"center"},gripDivider:{margin:"50px 0 20px 0"},gripReminder:{margin:"20px 0 20px 0"}});var xn=function(n){var e=n.editing,t=n.handleCancelButtonClick,l=n.validateChanges,u=n.validationConfirm,_=n.setValidationConfirm,m=(0,o.$)().t,p=_n(),f=(0,c.useContext)(s.Z),g=f.editingPriority,h=f.assignments,I=f.investments,S=f.has_duplicate_priority_values,A=f.getAssingments,j=f.getContractsToAssign,Z=f.contractNoAssignments,C=(0,c.useContext)(G.Z).setContent,v=(0,c.useState)(!1),b=(0,i.Z)(v,2),O=b[0],R=b[1],y=(0,c.useCallback)((function(){return(0,E.jsxs)(E.Fragment,{children:[g?(0,E.jsxs)(T.Z,{container:!0,children:[(0,E.jsx)(X.Z,{severity:"warning",className:p.gripReminder,children:m("GENERATION_INVESTMENTS_REMINDER_INFO_TEXT")}),(0,E.jsxs)(T.Z,{item:!0,container:!0,className:p.buttons,children:[(0,E.jsx)(B.Z,{id:"cancel-action-btn",variant:"contained",className:p.button,onClick:function(){return t(!1)},children:m("GENERATION_INVESTMENTS_CANCEL_BUTTON")}),(0,E.jsx)(B.Z,{id:"validation-action-btn",variant:"contained",className:p.button,onClick:function(){return l()},children:m("GENERATION_INVESTMENTS_VALIDATE_BUTTON")})]})]}):null,u.finished&&u.completed?(0,E.jsx)(T.Z,{item:!0,container:!0,className:p.buttons,children:(0,E.jsx)(X.Z,{id:"alert-success-message",severity:"success",className:p.gripReminder,onClose:function(){return _(!1)},children:m("GENERATION_INVESTMENTS_ASSIGNMENT_VALIDATION_SUCCESS")})}):null]})}),[m,p,g,_,u,t,l]);(0,c.useEffect)((function(){j()}),[]);var L=function(){var n=(0,a.Z)((0,r.Z)().mark((function n(e){return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,R(!0),C((0,E.jsx)(U,{withBackground:!1,blockHandleClose:!0,children:(0,E.jsx)(z.Z,{})})),n.next=5,(0,d.CV)(e);case 5:return n.next=7,j();case 7:R(!1),A(),n.next=14;break;case 11:n.prev=11,n.t0=n.catch(0),console.log(n.t0);case 14:C(void 0);case 15:case"end":return n.stop()}}),n,null,[[0,11]])})));return function(e){return n.apply(this,arguments)}}();return(0,E.jsx)(E.Fragment,{children:u.finished&&!u.completed?(0,E.jsx)(an,{}):(0,E.jsx)(E.Fragment,{children:0===I.length?(0,E.jsx)(N.Z,{variant:"body1",dangerouslySetInnerHTML:{__html:m("GENERATION_INFO_NOT_HAS_INVOICES")}}):S()?(0,E.jsx)(X.Z,{severity:"warning",children:(0,E.jsx)(N.Z,{id:"info-text-section",dangerouslySetInnerHTML:{__html:m("GENERATION_INVESTMENTS_SAME_PRIORITY_INFO_TEXT")}})}):(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(x,{text:m("GENERATION_INVESTMENTS_TABLE_TITLE")}),(0,E.jsx)(Q,{data:I}),(0,E.jsx)(T.Z,{item:!0,xs:12,className:p.gripDivider,children:(0,E.jsxs)(X.Z,{severity:"warning",children:[(0,E.jsx)(N.Z,{variant:"body2",dangerouslySetInnerHTML:{__html:m("GENERATION_INVESTMENTS_HELPER_TEXT_1")}}),(0,E.jsx)(N.Z,{variant:"body2",dangerouslySetInnerHTML:{__html:m("GENERATION_INVESTMENTS_HELPER_TEXT_2")}})]})}),(0,E.jsx)(x,{text:m("GENERATION_INVESTMENTS_ASSIGNMENTS_TABLE_TITLE"),children:I.length>0?(0,E.jsx)(B.Z,{className:p.altButton,disabled:O,type:"button",id:"generationkwh-id-add-assignment",variant:"contained",onClick:function(){return function(){var n=Z.map((function(n){return{id:n.id,primary:n.contract,secondary:n.contract_address}}));0===Z.length?C((0,E.jsx)(Y,{text:(0,E.jsx)(N.Z,{dangerouslySetInnerHTML:{__html:m("GENERATION_ADD_ASSIGNMENTS_INFO_NO_CONTRACTS_TEXT")}}),acceptFunction:function(){return C(void 0)}})):C((0,E.jsx)(U,{withBackground:!0,children:(0,E.jsx)(En,{data:n,title:m("GENERATION_ADD_CONTRACT_LIST_TITLE"),acceptFunction:L,cancelFunction:function(){return C(void 0)},acceptButtonText:m("GENERATION_ADD_CONTRACT_LIST_VALIDATE_CHANGES"),cancelButtonText:m("GENERATION_ADD_CONTRACT_LIST_CANCEL")})}))}()},endIcon:(0,E.jsx)(sn.Z,{}),children:m("GENERATION_BUTTON_ADD_ASSIGNMENT")}):null}),(0,E.jsx)(J,{data:h,editing:e}),(0,E.jsx)(T.Z,{className:p.footer,container:!0,justifyContent:"flex-end",children:(0,E.jsx)(y,{})}),(0,E.jsx)(x,{text:m("GENERATION_INVESTMENTS_LINK_TO_PROD_CONSUMPTION"),children:(0,E.jsx)(B.Z,{className:p.altButton,type:"button",id:"generationkwh-id-production-consumption",variant:"contained",onClick:function(){return window.location.replace("/investments/production-consumption")},endIcon:(0,E.jsx)(cn.Z,{}),children:m("GENERATION_BUTTON_ACCESS_PRODUCTION_CONSUMPTION")})})]})})})};t(3195),t(2563);var mn=function(n){var e=(0,c.useState)({finished:!1,completed:!1}),t=(0,i.Z)(e,2),u=t[0],T=t[1],N=(0,l.UO)().language,_=(0,o.$)().i18n,x=(0,c.useContext)(s.Z),m=x.assignments,p=x.resetAssignments,f=x.setEditingPriority,h=(0,c.useCallback)((function(){p()}),[p]),I=(0,c.useCallback)((0,a.Z)((0,r.Z)().mark((function n(){var e;return(0,r.Z)().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return f(!1),n.prev=1,e=m.map((function(n){return n.id})),n.next=5,(0,d.fo)(e);case 5:T({finished:!0,completed:!0}),n.next=12;break;case 8:n.prev=8,n.t0=n.catch(1),console.error("ERROR",n.t0),T({finished:!0,completed:!1});case 12:case"end":return n.stop()}}),n,null,[[1,8]])}))),[m,f]);return(0,c.useEffect)((function(){N&&_.changeLanguage(N),N?g().locale(N):g().locale("es")}),[N,_]),(0,E.jsx)(E.Fragment,{children:(0,E.jsx)(xn,{handleCancelButtonClick:h,validateChanges:I,validationConfirm:u,setValidationConfirm:T})})}}}]);
//# sourceMappingURL=657.7ef7a815.chunk.js.map