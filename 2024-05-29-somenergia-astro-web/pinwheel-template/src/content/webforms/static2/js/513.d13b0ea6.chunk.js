"use strict";(self.webpackChunkwebforms_ui=self.webpackChunkwebforms_ui||[]).push([[513],{7505:function(e,n,l){l(2791);var i=l(3168),t=l(9626),o=l(4279),a=l(184);n.Z=function(e){var n=(0,i.$)().t,l=e.values,r=e.handleBlur,s=e.errors,u=e.touched,d=e.numInputs,c=void 0===d?2:d,_=e.setFieldValue,v=e.namePrefix,p=void 0!==v&&v;return Array.from(Array(c).keys()).map((function(e){var i=0===e?"power":"power".concat(e+1),d="".concat(p?p+".":"").concat(i),v=null!==l&&void 0!==l&&l.has_service?n("QUINA_POTENCIA_TENS_CONTRACTADA"):n("POTENCIA_A_CONTRACTAR_CONTRACTACIO");return(0,a.jsx)(t.Z,{required:!0,id:i,name:d,label:v,InputProps:{autoComplete:"off",endAdornment:(0,a.jsx)(o.Z,{position:"end",children:"kW"}),startAdornment:c>1&&(0,a.jsx)(o.Z,{position:"start",children:c<=2?n(0===e?"PEAK":"VALLEY"):"P".concat(e+1)})},onChange:function(e){return function(e,n,l){var i=l.moreThanOneDecimal,t=void 0!==i&&i,o=l.moreThan15Kw,a=void 0!==o&&o,r=(t?/^\d*([.,'])?\d{0,3}/g:/^\d*([.,'])?\d{0,1}/g).exec(e.target.value)[0].replace(",",".");r=r.replace("'","."),!a&&r>15&&(r=r.slice(0,-1)),n(e.target.name,r)}(e,_,{moreThanOneDecimal:(null===l||void 0===l?void 0:l.has_service)||(null===l||void 0===l?void 0:l.moreThan15Kw),moreThan15Kw:null===l||void 0===l?void 0:l.moreThan15Kw})},onBlur:r,value:null===l||void 0===l?void 0:l[i],error:(null===s||void 0===s?void 0:s[i])&&(null===u||void 0===u?void 0:u[i]),helperText:(null===u||void 0===u?void 0:u[i])&&(null===s||void 0===s?void 0:s[i])||l.has_service&&n("HELP_POPOVER_POWER"),fullWidth:!0,variant:"outlined",margin:"normal"},i)}))}},8513:function(e,n,l){l.r(n),l.d(n,{default:function(){return Re}});var i,t,o=l(4165),a=l(5861),r=l(1413),s=l(9439),u=l(2791),d=l(6129),c=l(7268),_=l(3168),v=l(7325),p=l(5173),h=l(2797),m=l(7689),E=l(8596),T=l(6513),O=l(4265),I=l(5720),N=l(3712),x=(l(4446),l(9526)),L=l(6697),S=l(9329),f=l(6716),A=l(2439),C=l(8302),R=l(293),y=l(7084),j=l(2130),Z=l(184),P=function(e){var n=(0,_.$)().t;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(R.Z,{title:n("CONTRACT_TITLE")}),(0,Z.jsx)(C.Z,{variant:"body1",dangerouslySetInnerHTML:{__html:n("MEMBER_IDENTIFIER_DESC")}}),(0,Z.jsx)(O.Z,{mt:0,mb:1,children:(0,Z.jsx)(y.Z,(0,r.Z)({},e))}),e.is30ContractEnabled?null:(0,Z.jsx)(O.Z,{mt:0,mb:1,children:(0,Z.jsx)(j.Z,{severity:"warning",children:(0,Z.jsx)(C.Z,{variant:"body1",dangerouslySetInnerHTML:{__html:n("TARIFF_NOT_AVAILABLE")}})})})]})},g=l(1288),F=l(4279),b=l(9626),M=l(9650),D=l(8952),U=l(9299),w=(0,E.Z)((function(e){return{memberChecked:{fontWeight:500,color:e.palette.primary.main},chooserContainer:{"& h6":{fontSize:"1rem",fontWeight:500,marginTop:e.spacing(2)}}}})),H=function(){var e=(0,_.$)().t;return(0,Z.jsx)("a",{href:e("CUPS_HELP_URL"),target:"_blank",rel:"noopener noreferrer",children:e("CUPS_HELP")})},V=function(e){var n,l,i,t,o,a,r=(0,_.$)().t,d=w(),c=e.values,v=e.handleBlur,p=e.errors,h=e.touched,m=e.setFieldValue,E=e.setFieldTouched,T=(0,u.useState)(!1),N=(0,s.Z)(T,2),x=N[0],L=N[1];return(0,u.useEffect)((function(){var e=c.supply_point.cups;e.length>18?(L(!0),(0,U.s1)(e).then((function(e){var n,l=null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.status;m("supply_point.status",l),E("supply_point.cups",!0),L(!1)})).catch((function(e){var n,l,i,t,o,a;console.error(e.response);var r=null!==e&&void 0!==e&&null!==(n=e.response)&&void 0!==n&&null!==(l=n.data)&&void 0!==l&&null!==(i=l.data)&&void 0!==i&&i.status?null===e||void 0===e||null===(t=e.response)||void 0===t||null===(o=t.data)||void 0===o||null===(a=o.data)||void 0===a?void 0:a.status:"error";m("supply_point.status",r),L(!1)}))):m("supply_point.status","error")}),[c.supply_point.cups,m,E]),(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(R.Z,{title:r("CUPS_TITLE")}),(0,Z.jsx)(C.Z,{variant:"body1",dangerouslySetInnerHTML:{__html:r("FILL_CUPS")}}),(0,Z.jsx)(O.Z,{mt:1,mb:1,children:(0,Z.jsx)(g.Z,{container:!0,spacing:3,children:(0,Z.jsx)(g.Z,{item:!0,xs:12,children:(0,Z.jsx)(b.Z,{required:!0,id:"cups",name:"supply_point.cups",label:r("CUPS"),onChange:function(e){var n=e.target.value.match(/[0-9A-Za-z]{0,22}/);n=n[0].toUpperCase(),m("supply_point.cups",n,!0)},onBlur:v,value:c.supply_point.cups,fullWidth:!0,variant:"outlined",margin:"normal",InputProps:{endAdornment:(0,Z.jsxs)(F.Z,{position:"end",children:[x&&(0,Z.jsx)(I.Z,{size:24}),!x&&("new"===(null===c||void 0===c||null===(n=c.supply_point)||void 0===n?void 0:n.status)||"inactive"===(null===c||void 0===c||null===(l=c.supply_point)||void 0===l?void 0:l.status))&&(0,Z.jsx)(M.Z,{color:"primary"})]})},error:(null===p||void 0===p||null===(i=p.supply_point)||void 0===i?void 0:i.cups)&&(null===h||void 0===h||null===(t=h.supply_point)||void 0===t?void 0:t.cups),helperText:(null===h||void 0===h||null===(o=h.supply_point)||void 0===o?void 0:o.cups)&&(0,Z.jsx)("span",{dangerouslySetInnerHTML:{__html:null===p||void 0===p||null===(a=p.supply_point)||void 0===a?void 0:a.cups}})||(0,Z.jsx)(H,{})})})})}),(0,Z.jsx)(O.Z,{mt:1,mb:2,className:d.chooserContainer,children:(0,Z.jsx)(D.Z,{question:r("HI_HA_LLUM_AL_PUNT_DE_SUBMINISTRAMENT"),onChange:function(e){var n=e.option;m("contract",{rate:"",power:"",power2:"",power3:"",fare:"",phases:"",moreThan15Kw:!1},!1),m("holder.previous_holder",!1!==n&&"",!1),m("contract.has_service",n)},value:c.contract.has_service,disabled:"new"!==c.supply_point.status&&"inactive"!==c.supply_point.status,options:[{value:!0,label:r("AVIS_CANVI_COMERCIALITZADORA_LABEL"),description:r("AVIS_CANVI_COMERCIALITZADORA_DESC")},{value:!1,label:r("AVIS_ALTA_DE_SERVEI_LABEL"),description:r("AVIS_ALTA_DE_SERVEI_DESC")}]})})]})},B=l(5247),W=l(4135),q=l(1859),Y=l(7398),X=l(442),k=l(5815),G=function(e){var n=e.name,l=e.id,i=e.label,t=e.variant,o=e.value,a=void 0===o?"":o,r=e.onChange,d=e.onBlur,c=e.error,_=e.helperText,v=e.disabled,p=void 0!==v&&v,h=e.autoFocus,m=void 0!==h&&h,E=(0,u.useState)(!1),T=(0,s.Z)(E,2),O=T[0],N=T[1],x=(0,u.useState)(!1),L=(0,s.Z)(x,2),S=L[0],f=L[1],A=(0,u.useState)(a),C=(0,s.Z)(A,2),R=C[0],y=C[1],j=(0,u.useState)(!1),P=(0,s.Z)(j,2),g=P[0],D=P[1];(0,u.useEffect)((function(){f(!1),D(!1),r({cnae:R,valid:!1}),R.length>3&&(N(!0),(0,U.MP)(R).then((function(e){var n,l=!0===(null===e||void 0===e?void 0:e.state);f(l),D(null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.description),N(!1),r({cnae:R,valid:l})})).catch((function(e){var n,l,i,t,o,a;console.error(e.response);var s=!(null===e||void 0===e||null===(n=e.response)||void 0===n||null===(l=n.data)||void 0===l||null===(i=l.data)||void 0===i||!i.valid)&&(null===e||void 0===e||null===(t=e.response)||void 0===t||null===(o=t.data)||void 0===o||null===(a=o.data)||void 0===a?void 0:a.valid);f(s),D(!1),N(!1),r({cnae:R,valid:S})})))}),[R]);return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(b.Z,{id:l,name:n,label:i,variant:t,fullWidth:!0,required:!0,disabled:p,autoFocus:m,value:a,onChange:function(e){var n=e.target.value.match(/[0-9]{0,8}/);n=n[0],y(n)},onBlur:function(e){d(e)},error:!O&&c,helperText:(0,Z.jsx)("span",{dangerouslySetInnerHTML:{__html:!O&&(""!==a&&g||_)}}),InputProps:{endAdornment:(0,Z.jsxs)(F.Z,{position:"end",children:[O&&(0,Z.jsx)(I.Z,{size:24}),!O&&""!==a&&S&&(0,Z.jsx)(M.Z,{color:"primary"})]})}})})},K=l(1070),Q=l(5509),z=(0,E.Z)((function(e){return{memberChecked:{fontWeight:500,color:e.palette.primary.main},noPaddingTop:{paddingTop:"0 !important"}}})),$=function(){var e=(0,_.$)().t;return(0,Z.jsx)("span",{dangerouslySetInnerHTML:{__html:e("HELP_CADASTRAL_REFERENCE",{cadastral_reference_url:e("CADASTRAL_REFERENCE_URL")})}})},J=function(e){var n,l,i,t,r,d,c,v,p,h,m,E,T,I,N,x,L,S,f,A,y,j,P,F,M,D,w,H,V,J,ee,ne,le,ie,te,oe,ae,re,se,ue,de,ce,_e,ve,pe,he,me,Ee,Te,Oe,Ie,Ne,xe,Le,Se,fe,Ae,Ce,Re=(0,_.$)().t,ye=z(),je=e.values,Ze=e.handleBlur,Pe=e.handleChange,ge=e.errors,Fe=e.touched,be=e.setFieldValue,Me=e.setFieldTouched,De=(0,u.useState)(!1),Ue=(0,s.Z)(De,2),we=Ue[0],He=Ue[1],Ve=function(e){var n=e.cnae,l=e.valid,i=e.touched;Me("supply_point.cnae",void 0===i||i),be("supply_point.cnae",n),be("supply_point.cnae_valid",l)};return(0,u.useEffect)((function(){var e,n,l,i=function(){var e=(0,a.Z)((0,o.Z)().mark((function e(n){var l,i,t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,U.Kr)(n);case 2:(l=e.sent).length>0&&(be("supply_point.state",null===(i=l[0][0])||void 0===i?void 0:i.provincia),be("supply_point.city",null===(t=l[0][0])||void 0===t?void 0:t.municipi));case 4:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}(),t=null===je||void 0===je||null===(e=je.supply_point)||void 0===e?void 0:e.postal_code;t.length>4&&""===(null===je||void 0===je||null===(n=je.supply_point)||void 0===n||null===(l=n.city)||void 0===l?void 0:l.id)&&i(t)}),[null===je||void 0===je||null===(n=je.supply_point)||void 0===n?void 0:n.postal_code]),(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(R.Z,{title:Re("SUPPLY")}),(0,Z.jsx)(C.Z,{variant:"body1",dangerouslySetInnerHTML:{__html:Re("FILL_SUPPLY_POINT")}}),(0,Z.jsx)(O.Z,{mt:3,mb:1,children:(0,Z.jsxs)(g.Z,{container:!0,spacing:3,children:[(0,Z.jsx)(g.Z,{item:!0,xs:12,sm:12,children:(0,Z.jsx)(b.Z,{id:"supply_point_address",name:"supply_point.address",label:Re("HOLDER_ADDRESS"),required:!0,variant:"outlined",fullWidth:!0,value:null===je||void 0===je||null===(l=je.supply_point)||void 0===l?void 0:l.address,onChange:Pe,onBlur:Ze,error:(null===ge||void 0===ge||null===(i=ge.supply_point)||void 0===i?void 0:i.address)&&(null===Fe||void 0===Fe||null===(t=Fe.supply_point)||void 0===t?void 0:t.address),helperText:(null===Fe||void 0===Fe||null===(r=Fe.supply_point)||void 0===r?void 0:r.address)&&(null===ge||void 0===ge||null===(d=ge.supply_point)||void 0===d?void 0:d.address)})}),(0,Z.jsx)(g.Z,{item:!0,xs:4,sm:2,children:(0,Z.jsx)(b.Z,{id:"supply_point_number",name:"supply_point.number",label:Re("NUMBER"),required:!0,variant:"outlined",fullWidth:!0,value:null===je||void 0===je||null===(c=je.supply_point)||void 0===c?void 0:c.number,onChange:Pe,onBlur:Ze,error:(null===ge||void 0===ge||null===(v=ge.supply_point)||void 0===v?void 0:v.number)&&(null===Fe||void 0===Fe||null===(p=Fe.supply_point)||void 0===p?void 0:p.number),helperText:(null===Fe||void 0===Fe||null===(h=Fe.supply_point)||void 0===h?void 0:h.number)&&(null===ge||void 0===ge||null===(m=ge.supply_point)||void 0===m?void 0:m.number)})}),(0,Z.jsx)(g.Z,{item:!0,xs:4,sm:2,children:(0,Z.jsx)(b.Z,{id:"supply_point_floor",name:"supply_point.floor",label:Re("FLOOR"),variant:"outlined",fullWidth:!0,value:null===je||void 0===je||null===(E=je.supply_point)||void 0===E?void 0:E.floor,onChange:Pe,onBlur:Ze,error:(null===ge||void 0===ge||null===(T=ge.supply_point)||void 0===T?void 0:T.floor)&&(null===Fe||void 0===Fe||null===(I=Fe.supply_point)||void 0===I?void 0:I.floor),helperText:(null===Fe||void 0===Fe||null===(N=Fe.supply_point)||void 0===N?void 0:N.floor)&&(null===ge||void 0===ge||null===(x=ge.supply_point)||void 0===x?void 0:x.floor)})}),(0,Z.jsx)(g.Z,{item:!0,xs:4,sm:2,children:(0,Z.jsx)(b.Z,{id:"supply_point_door",name:"supply_point.door",label:Re("DOOR"),variant:"outlined",fullWidth:!0,value:null===je||void 0===je||null===(L=je.supply_point)||void 0===L?void 0:L.door,onChange:Pe,onBlur:Ze,error:(null===ge||void 0===ge||null===(S=ge.supply_point)||void 0===S?void 0:S.door)&&(null===Fe||void 0===Fe||null===(f=Fe.supply_point)||void 0===f?void 0:f.door),helperText:(null===Fe||void 0===Fe||null===(A=Fe.supply_point)||void 0===A?void 0:A.door)&&(null===ge||void 0===ge||null===(y=ge.supply_point)||void 0===y?void 0:y.door)})}),(0,Z.jsx)(g.Z,{item:!0,xs:12,sm:6,children:(0,Z.jsx)(b.Z,{id:"supply_point_postal_code",name:"supply_point.postal_code",label:Re("HOLDER_POSTALCODE"),variant:"outlined",required:!0,fullWidth:!0,value:null===je||void 0===je||null===(j=je.supply_point)||void 0===j?void 0:j.postal_code,onChange:Pe,onBlur:Ze,error:(null===ge||void 0===ge||null===(P=ge.supply_point)||void 0===P?void 0:P.postal_code)&&(null===Fe||void 0===Fe||null===(F=Fe.supply_point)||void 0===F?void 0:F.postal_code),helperText:(null===Fe||void 0===Fe||null===(M=Fe.supply_point)||void 0===M?void 0:M.postal_code)&&(null===ge||void 0===ge||null===(D=ge.supply_point)||void 0===D?void 0:D.postal_code)})}),(0,Z.jsx)(Y.Z,{stateId:"supply_point_state",stateName:"supply_point.state",stateInitial:null===je||void 0===je||null===(w=je.supply_point)||void 0===w?void 0:w.state,stateError:(null===ge||void 0===ge||null===(H=ge.supply_point)||void 0===H?void 0:H.state)&&(null===Fe||void 0===Fe||null===(V=Fe.supply_point)||void 0===V?void 0:V.state),stateHelperText:(null===Fe||void 0===Fe||null===(J=Fe.supply_point)||void 0===J?void 0:J.state)&&(null===ge||void 0===ge||null===(ee=ge.supply_point)||void 0===ee?void 0:ee.state),cityId:"supply_point_city",cityName:"supply_point.city",cityInitial:null===je||void 0===je||null===(ne=je.supply_point)||void 0===ne?void 0:ne.city,cityError:(null===ge||void 0===ge||null===(le=ge.supply_point)||void 0===le?void 0:le.city)&&(null===Fe||void 0===Fe||null===(ie=Fe.supply_point)||void 0===ie?void 0:ie.city),cityHelperText:(null===Fe||void 0===Fe||null===(te=Fe.supply_point)||void 0===te?void 0:te.city)&&(null===ge||void 0===ge||null===(oe=ge.supply_point)||void 0===oe?void 0:oe.city),onChange:function(e){var n=e.state,l=e.city;be("supply_point.state",n,!1),be("supply_point.city",l)}}),(0,Z.jsx)(g.Z,{item:!0,xs:12,sm:6,children:(0,Z.jsxs)(b.Z,{select:!0,id:"supply_point_is_housing",name:"supply_point.is_housing",label:Re("ES_UN_HABITATGE"),required:!0,variant:"outlined",fullWidth:!0,value:null===je||void 0===je||null===(ae=je.supply_point)||void 0===ae?void 0:ae.is_housing,onChange:function(e){e.preventDefault();var n=e.target.value;be("supply_point.is_housing",e.target.value,!1),Ve(n?{cnae:K.C2,valid:!0,touched:!0}:{cnae:"",valid:!1,touched:!1})},onBlur:Ze,error:(null===ge||void 0===ge||null===(re=ge.supply_point)||void 0===re?void 0:re.is_housing)&&(null===Fe||void 0===Fe||null===(se=Fe.supply_point)||void 0===se?void 0:se.is_housing),helperText:(null===Fe||void 0===Fe||null===(ue=Fe.supply_point)||void 0===ue?void 0:ue.is_housing)&&(null===ge||void 0===ge||null===(de=ge.supply_point)||void 0===de?void 0:de.is_housing),children:[(0,Z.jsx)(q.Z,{value:!0,children:Re("YES")}),(0,Z.jsx)(q.Z,{value:!1,children:Re("NO")})]})}),(0,Z.jsx)(g.Z,{item:!0,xs:12,sm:6,children:(0,Z.jsx)(G,{name:"supply_point.cnae",label:Re("CNAE"),required:!0,disabled:!(!1===je.supply_point.is_housing),variant:"outlined",id:"supply_point_cnae",fullWidth:!0,value:null===je||void 0===je||null===(ce=je.supply_point)||void 0===ce?void 0:ce.cnae,onChange:Ve,onBlur:Ze,error:(null===ge||void 0===ge||null===(_e=ge.supply_point)||void 0===_e?void 0:_e.cnae_valid)&&(null===Fe||void 0===Fe||null===(ve=Fe.supply_point)||void 0===ve?void 0:ve.cnae),helperText:(null===Fe||void 0===Fe||null===(pe=Fe.supply_point)||void 0===pe?void 0:pe.cnae)&&(null===ge||void 0===ge||null===(he=ge.supply_point)||void 0===he?void 0:he.cnae_valid)||Re("HELP_POPOVER_CNAE")})}),e.isCadastralReference?(0,Z.jsx)(g.Z,{item:!0,xs:6,sm:6,children:(0,Z.jsx)(Q.Z,{id:"supply_point_cadastral_reference",name:"supply_point.cadastral_reference",label:Re("CADASTRAL_REFERENCE"),variant:"outlined",fullWidth:!0,value:null===je||void 0===je||null===(me=je.supply_point)||void 0===me?void 0:me.cadastral_reference,onChange:function(e){var n=e.value,l=(e.valid,e.error);be("supply_point.cadastral_reference",n),be("supply_point.cadastral_reference_error",l)},onBlur:Ze,error:(null===je||void 0===je||null===(Ee=je.supply_point)||void 0===Ee?void 0:Ee.cadastral_reference)&&!(null===ge||void 0===ge||null===(Te=ge.supply_point)||void 0===Te||!Te.cadastral_reference),helperText:null!==je&&void 0!==je&&null!==(Oe=je.supply_point)&&void 0!==Oe&&Oe.cadastral_reference&&null!==ge&&void 0!==ge&&null!==(Ie=ge.supply_point)&&void 0!==Ie&&Ie.cadastral_reference?null===ge||void 0===ge||null===(Ne=ge.supply_point)||void 0===Ne?void 0:Ne.cadastral_reference:(0,Z.jsx)($,{})})}):null,(0,Z.jsxs)(g.Z,{item:!0,xs:12,className:ye.noPaddingTop,children:[null!==je&&void 0!==je&&null!==(xe=je.contract)&&void 0!==xe&&xe.has_service?(0,Z.jsx)(C.Z,{children:Re("ADJUNTAR_ULTIMA_FACTURA")}):(0,Z.jsx)(C.Z,{children:Re("ADJUNTAR_DOCUMENTACIO")}),(0,Z.jsx)(O.Z,{mt:1,mb:1,children:(0,Z.jsx)(k.Z,{fieldError:(null===(Le=ge.supply_point)||void 0===Le?void 0:Le.attachments)&&(null===(Se=Fe.supply_point)||void 0===Se?void 0:Se.attachments)&&(null===(fe=ge.supply_point)||void 0===fe?void 0:fe.attachments),callbackFn:function(e){return be("supply_point.attachments",e)},values:je.supply_point.attachments,maxFiles:null!==je&&void 0!==je&&null!==(Ae=je.contract)&&void 0!==Ae&&Ae.has_service?1:5})})]})]})}),(0,Z.jsx)(O.Z,{mt:1,mb:2,children:(0,Z.jsx)(W.Z,{control:(0,Z.jsx)(B.Z,{id:"supply_point_accepted",color:"primary",name:"supply_point_accepted",onClick:function(e){e.preventDefault(),He(!0)},checked:null===je||void 0===je||null===(Ce=je.supply_point)||void 0===Ce?void 0:Ce.supply_point_accepted,value:!0}),label:Re("FAIR_TITLE_LABEL")})}),(0,Z.jsx)(X.Z,{title:Re("FAIR_TITLE"),open:we,onAccept:function(){He(!1),be("supply_point.supply_point_accepted",!0)},onClose:function(){He(!1),be("supply_point.supply_point_accepted",!1)},maxWidth:"sm",children:(0,Z.jsx)("span",{dangerouslySetInnerHTML:{__html:Re("PRIVACY_POLICY_SUPLYPOINT")}})})]})},ee=l(6782),ne=l(7505),le=function(e){var n,l,i,t,o,a,s,d,c,v,p,h,m,E,T,I,N,x=(0,_.$)().t,L=e.values,S=e.handleBlur,f=e.handleChange,A=e.errors,y=e.touched,P=e.rates,g=e.setFieldValue,F=e.isIndexedContractEnabled,M=e.is30ContractEnabled,U=void 0!==M&&M;return(0,u.useEffect)((function(){var e=(0,K.yS)(L.contract);g("contract.rate",e)}),[L.contract,L.contract.moreThan15Kw]),(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(R.Z,{title:x(!0===(null===L||void 0===L||null===(n=L.contract)||void 0===n?void 0:n.has_service)?"POWER":"TENSION_AND_POWER")}),(0,Z.jsx)(C.Z,{variant:"body1",dangerouslySetInnerHTML:{__html:x(!0===(null===L||void 0===L||null===(l=L.contract)||void 0===l?void 0:l.has_service)?"HELP_POWER_CANVI":"HELP_TENSION_POWER_ALTA")}}),!1===(null===L||void 0===L||null===(i=L.contract)||void 0===i?void 0:i.has_service)&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(O.Z,{mt:3,mb:0,children:(0,Z.jsxs)(b.Z,{select:!0,required:!0,id:"phases",name:"contract.phases",label:x("TIPUS_INSTALLACIO_CONTRACTACIO"),variant:"outlined",margin:"normal",fullWidth:!0,onChange:f,onBlur:S,value:null===L||void 0===L||null===(t=L.contract)||void 0===t?void 0:t.phases,error:(null===A||void 0===A||null===(o=A.contract)||void 0===o?void 0:o.phases)&&(null===y||void 0===y||null===(a=y.contract)||void 0===a?void 0:a.phases),helperText:(null===y||void 0===y||null===(s=y.contract)||void 0===s?void 0:s.phases)&&(null===A||void 0===A||null===(d=A.contract)||void 0===d?void 0:d.phases),children:[(0,Z.jsx)(q.Z,{value:"mono",children:x("PHASE_MONO")}),(0,Z.jsx)(q.Z,{value:"tri",children:x("PHASE_TRI")})]})}),(0,Z.jsx)(O.Z,{mx:1,mt:0,mb:1,children:(0,Z.jsx)(ee.Z,{dangerouslySetInnerHTML:{__html:x("HELP_INSTALL_TYPE",{url:x("HELP_INSTALL_TYPE_URL")})}})})]}),(0,Z.jsx)(O.Z,{mt:3,mb:1,children:(0,Z.jsx)(D.Z,{name:"moreThan15Kw",condensed:!0,canBeEmpty:!1,question:x(null!==L&&void 0!==L&&null!==(c=L.contract)&&void 0!==c&&c.has_service?x("QUINA_POTENCIA_TENS_CONTRACTADA"):x("POTENCIA_A_CONTRACTAR_CONTRACTACIO")),onChange:function(e){var n=e.option;g("contract.moreThan15Kw",n)},value:null===L||void 0===L||null===(v=L.contract)||void 0===v?void 0:v.moreThan15Kw,options:[{value:!1,label:x("MENOR_IGUAL_A_15KW_CONTRACTACIO")},{value:!0,label:x("MES_GRAN_DE_15KW_CONTRACTACIO")}]})}),(null===L||void 0===L||null===(p=L.contract)||void 0===p?void 0:p.moreThan15Kw)&&!U&&(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(O.Z,{mt:3,children:(0,Z.jsx)(j.Z,{severity:"warning",children:(0,Z.jsx)(C.Z,{variant:"body1",dangerouslySetInnerHTML:{__html:x("TARIFF_NOT_AVAILABLE")}})})})}),(!(null!==L&&void 0!==L&&null!==(h=L.contract)&&void 0!==h&&h.moreThan15Kw)||U)&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(O.Z,{mt:3,children:F?(0,Z.jsx)(ee.Z,{dangerouslySetInnerHTML:{__html:x("POWER_PERIODS_MORE_INFO",{tariff:null===L||void 0===L?void 0:L.tariff,periods_url:null!==L&&void 0!==L&&null!==(m=L.contract)&&void 0!==m&&m.moreThan15Kw?x("POWER_PERIODS_30TD_MORE_INFO_URL"):x("POWER_PERIODS_20TD_MORE_INFO_URL"),indexed_url:null!==L&&void 0!==L&&null!==(E=L.contract)&&void 0!==E&&E.moreThan15Kw?x("POWER_INDEXED_30TD_MORE_INFO_URL"):x("POWER_INDEXED_20TD_MORE_INFO_URL")})}}):(0,Z.jsx)(ee.Z,{dangerouslySetInnerHTML:{__html:x("POWER_PERIODS_MORE_INFO__DEPRECATED",{tariff:null===L||void 0===L?void 0:L.tariff,url:null!==L&&void 0!==L&&null!==(T=L.contract)&&void 0!==T&&T.moreThan15Kw?x("POWER_PERIODS_30TD_MORE_INFO_URL"):x("POWER_PERIODS_20TD_MORE_INFO_URL")})}})}),(0,Z.jsx)(O.Z,{mt:2,mb:1,children:(0,Z.jsx)(ne.Z,(0,r.Z)((0,r.Z)({namePrefix:"contract",numInputs:null===(I=P[null===L||void 0===L||null===(N=L.contract)||void 0===N?void 0:N.rate])||void 0===I?void 0:I.num_power_periods},e),{},{values:null===L||void 0===L?void 0:L.contract,errors:null===A||void 0===A?void 0:A.contract,touched:null===y||void 0===y?void 0:y.contract}))})]})]})},ie=(0,E.Z)((function(e){return{chooserQuestionTariffMode:{"& .MuiFormHelperText-root":{fontSize:"0.9rem"}}}})),te=function(e){var n,l,i=ie(),t=(0,_.$)().t;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(R.Z,{title:t("TARIFF_MODE_TITLE")}),(0,Z.jsx)(O.Z,{mt:3,mb:2,className:i.chooserQuestionTariffMode,children:(0,Z.jsx)(D.Z,{name:"tariffMode",question:t("TARIFF_MODE_QUESTION"),onChange:function(n){var l=n.option;e.setFieldValue("contract.isIndexed",l)},value:null===e||void 0===e||null===(n=e.values)||void 0===n||null===(l=n.contract)||void 0===l?void 0:l.isIndexed,canBeEmpty:!1,options:[{value:!1,label:e.values.contract.moreThan15Kw?t("TARIFF_MODE_PERIODS_30TD_LABEL"):t("TARIFF_MODE_PERIODS_20TD_LABEL"),description:e.values.contract.moreThan15Kw?t("TARIFF_MODE_PERIODS_30TD_DESC",{prices_url:t("TARIFF_MODE_30TD_PRICES_URL"),periods_url:t("TARIFF_MODE_30TD_PERIODS_URL")}):t("TARIFF_MODE_PERIODS_20TD_DESC",{prices_url:t("TARIFF_MODE_20TD_PRICES_URL"),periods_url:t("TARIFF_MODE_20TD_PERIODS_URL")})},{value:!0,label:e.values.contract.moreThan15Kw?t("TARIFF_MODE_INDEXED_30TD_LABEL"):t("TARIFF_MODE_INDEXED_20TD_LABEL"),description:t("TARIFF_MODE_INDEXED_DESC")+t("TARIFF_MODE_INDEXED_MORE",{indexed_url:t("TARIFF_MODE_INDEXED_URL")})}]})}),(0,Z.jsx)(C.Z,{variant:"body1",dangerouslySetInnerHTML:{__html:t("TARIFF_MODE_TARIFF_COMPARISON",{url:t("TARIFF_MODE_TARIFF_COMPARISON_URL")})}})]})},oe=function(e){var n=ae(),l=(0,_.$)().t;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(R.Z,{title:l("SELFCONSUMPTION_TITLE")}),(0,Z.jsxs)(O.Z,{mt:3,mb:2,children:[(0,Z.jsx)(D.Z,{className:n.chooserQuestion,question:l("SELFCONSUMPTION_QUESTION"),onChange:function(n){var l=n.option;e.setFieldValue("self_consumption.have_installation",l)},value:e.values.self_consumption.have_installation,canBeEmpty:!1,options:[{value:!0,label:l("SELFCONSUMPTION_YES_LABEL"),helper:(0,Z.jsx)(ee.Z,{variant:"outlined",children:(0,Z.jsx)("a",{href:l("SELFCONSUMPTION_HELP_URL"),target:"_blank",rel:"noopener noreferrer",children:l("SELFCONSUMPTION_HELP")})})},{value:!1,label:l("SELFCONSUMPTION_NO_LABEL")}]}),e.values.self_consumption.have_installation&&(0,Z.jsx)(O.Z,{mt:3,mb:0,children:(0,Z.jsx)(C.Z,{variant:"body1",dangerouslySetInnerHTML:{__html:l("SELFCONSUMPTION_WARNING")}})})]})]})},ae=(0,E.Z)((function(e){return{chooserQuestion:{"& h6":{fontWeight:400},"& label":{minHeight:"80px"}}}})),re=l(525),se=function(e){var n,l,i,t,o,a,r,d,c,v,p,h,m,E,T,O,I,N,x,L,S,f=e.values,A=e.errors,y=e.touched,j=(e.handleChange,e.handleBlur),P=e.setFieldValue,M=ue(),w=(0,_.$)().t,H=function(e){P("".concat(e.target.name,"_title"),e.currentTarget.getAttribute("data-title"),!1),P(e.target.name,e.target.value)},V=(0,u.useState)([]),B=(0,s.Z)(V,2),W=B[0],Y=B[1],X=(0,u.useState)(!1),G=(0,s.Z)(X,2),K=G[0],Q=G[1],z=(0,u.useState)([]),$=(0,s.Z)(z,2),J=$[0],ne=$[1],le=(0,u.useState)(!1),ie=(0,s.Z)(le,2),te=ie[0],oe=ie[1];return(0,u.useEffect)((function(){oe(!0),(0,U.BE)().then((function(e){ne(null===e||void 0===e?void 0:e.data),oe(!1)})).catch((function(e){console.error(e),oe(!1)}))}),[]),(0,u.useEffect)((function(){Q(!0),(0,U.ck)().then((function(e){Y(null===e||void 0===e?void 0:e.data),Q(!1)})).catch((function(e){console.error(e),Q(!1)}))}),[]),(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(R.Z,{title:w("SELFCONSUMPTION_DETAILS_TITLE")}),(0,Z.jsxs)(g.Z,{container:!0,spacing:3,children:[(0,Z.jsxs)(g.Z,{item:!0,xs:12,children:[(0,Z.jsx)(C.Z,{variant:"body1",dangerouslySetInnerHTML:{__html:w("SELFCONSUMPTION_CAU_CODE")},className:M.fieldTitle}),(0,Z.jsx)(re.Z,{required:!0,id:"self_consumption_cau",name:"self_consumption.cau",label:w("CAU"),variant:"outlined",fullWidth:!0,value:f.self_consumption.cau,onChange:function(e){P("self_consumption.cau",e.value),P("self_consumption.cau_error",e.error)},onBlur:j,error:(null===f||void 0===f||null===(n=f.self_consumption)||void 0===n?void 0:n.cau)&&!(null===A||void 0===A||null===(l=A.self_consumption)||void 0===l||!l.cau),helperText:(null===A||void 0===A||null===(i=A.self_consumption)||void 0===i?void 0:i.cau)||(0,Z.jsx)("a",{href:w("SELFCONSUMPTION_CAU_HELP_URL"),target:"_blank",rel:"noopener noreferrer",children:w("SELFCONSUMPTION_CAU_HELP")})})]}),(0,Z.jsx)(g.Z,{item:!0,xs:12,children:(0,Z.jsx)(D.Z,{name:"self_consumption.collective_installation",className:M.chooserQuestion,question:w("SELFCONSUMPTION_COLLECTIVE_INSTALLATION_QUESTION"),onChange:function(e){var n=e.option;P("self_consumption.collective_installation",n)},value:e.values.self_consumption.collective_installation,options:[{value:!1,label:w("SELFCONSUMPTION_INDIVIDUAL_INSTALLATION_LABEL"),description:w("SELFCONSUMPTION_INDIVIDUAL_INSTALLATION_HELP")},{value:!0,label:w("SELFCONSUMPTION_COLLECTIVE_INSTALLATION_LABEL"),description:w("SELFCONSUMPTION_COLLECTIVE_INSTALLATION_HELP")}]})}),(0,Z.jsxs)(g.Z,{item:!0,xs:12,children:[(0,Z.jsx)(C.Z,{variant:"body1",dangerouslySetInnerHTML:{__html:w("SELFCONSUMPTION_INSTALL_POWER_QUESTION")},className:M.fieldTitle}),(0,Z.jsx)(b.Z,{required:!0,id:"self_consumption_install_power",name:"self_consumption.installation_power",label:w("SELFCONSUMPTION_INSTALL_POWER"),variant:"outlined",fullWidth:!0,InputProps:{endAdornment:(0,Z.jsx)(F.Z,{position:"end",children:"kWp"})},value:f.self_consumption.installation_power,onChange:function(e){var n=/^\d*([.,'])?\d{0,3}/g.exec(e.target.value)[0].replace(",",".");n=n.replace("'","."),P(e.target.name,n)},onBlur:j,error:(null===A||void 0===A||null===(t=A.self_consumption)||void 0===t?void 0:t.installation_power)&&(null===y||void 0===y||null===(o=y.self_consumption)||void 0===o?void 0:o.installation_power),helperText:(null===y||void 0===y||null===(a=y.self_consumption)||void 0===a?void 0:a.installation_power)&&(null===A||void 0===A||null===(r=A.self_consumption)||void 0===r?void 0:r.installation_power)||(0,Z.jsx)("a",{href:w("SELFCONSUMPTION_INSTALL_POWER_HELP_URL"),target:"_blank",rel:"noopener noreferrer",children:w("SELFCONSUMPTION_INSTALL_POWER_HELP")})})]}),(0,Z.jsxs)(g.Z,{item:!0,xs:12,sm:6,children:[(0,Z.jsx)(C.Z,{variant:"body1",dangerouslySetInnerHTML:{__html:w("SELFCONSUMPTION_INSTALLATION_SITUATION_QUESTION")},className:M.fieldTitle}),(0,Z.jsx)(b.Z,{select:!0,required:!0,id:"self_consumption_installation_type",name:"self_consumption.installation_type",label:w("SELFCONSUMPTION_INSTALLATION_SITUATION_QUESTION"),variant:"outlined",fullWidth:!0,value:(null===f||void 0===f||null===(d=f.self_consumption)||void 0===d?void 0:d.installation_type)||"",onChange:H,onBlur:j,disabled:K,error:(null===A||void 0===A||null===(c=A.self_consumption)||void 0===c?void 0:c.installation_type)&&(null===y||void 0===y||null===(v=y.self_consumption)||void 0===v?void 0:v.installation_type),helperText:(null===y||void 0===y||null===(p=y.self_consumption)||void 0===p?void 0:p.installation_type)&&(null===A||void 0===A||null===(h=A.self_consumption)||void 0===h?void 0:h.installation_type)||(0,Z.jsx)("a",{href:w("SELFCONSUMPTION_INSTALLATION_SITUATION_HELP_URL"),target:"_blank",rel:"noopener noreferrer",children:w("SELFCONSUMPTION_INSTALLATION_SITUATION_HELP")}),children:W.map((function(e){return(0,Z.jsx)(q.Z,{value:e.id,"data-title":e.name,children:w(e.name)},e.id)}))})]}),(0,Z.jsxs)(g.Z,{item:!0,xs:12,sm:6,children:[(0,Z.jsx)(C.Z,{variant:"body1",dangerouslySetInnerHTML:{__html:w("SELFCONSUMPTION_TECHNOLOGY_QUESTION")},className:M.fieldTitle}),(0,Z.jsx)(b.Z,{select:!0,required:!0,id:"self_consumption_technology",name:"self_consumption.technology",label:w("SELFCONSUMPTION_TECHNOLOGY_QUESTION"),variant:"outlined",fullWidth:!0,value:(null===f||void 0===f||null===(m=f.self_consumption)||void 0===m?void 0:m.technology)||"",onChange:H,onBlur:j,disabled:te,error:(null===A||void 0===A||null===(E=A.self_consumption)||void 0===E?void 0:E.technology)&&(null===y||void 0===y||null===(T=y.self_consumption)||void 0===T?void 0:T.technology),helperText:(null===y||void 0===y||null===(O=y.self_consumption)||void 0===O?void 0:O.technology)&&(null===A||void 0===A||null===(I=A.self_consumption)||void 0===I?void 0:I.technology)||(0,Z.jsx)("a",{href:w("SELFCONSUMPTION_TECHNOLOGY_HELP_URL"),target:"_blank",rel:"noopener noreferrer",children:w("SELFCONSUMPTION_TECHNOLOGY_HELP")}),children:J.map((function(e){return(0,Z.jsx)(q.Z,{value:e.id,"data-title":e.name,children:w(e.name)},e.id)}))})]}),(0,Z.jsx)(g.Z,{item:!0,xs:12,children:(0,Z.jsx)(D.Z,{name:"self_consumption.aux_services",className:M.chooserQuestion,question:w("SELFCONSUMPTION_DETAILS_QUESTION_AUXILIARY_SERVICE"),onChange:function(e){var n=e.option;P("self_consumption.aux_services",n)},value:e.values.self_consumption.aux_services,options:[{value:!0,label:w("SELFCONSUMPTION_DETAILS_AUXILIARY_SERVICE_YES_LABEL"),description:w("SELFCONSUMPTION_DETAILS_AUXILIARY_SERVICE_YES_LABEL_DESCRIPTION"),helper:(0,Z.jsx)(ee.Z,{variant:"outlined",children:(0,Z.jsx)("a",{href:w("SELFCONSUMPTION_AUXILIARY_SERVICE_HELP_URL"),target:"_blank",technology:!0,rel:"noopener noreferrer",children:w("SELFCONSUMPTION_AUXILIARY_SERVICE_HELP")})})},{value:!1,label:w("SELFCONSUMPTION_DETAILS_AUXILIARY_SERVICE_NO_LABEL")}]})}),(0,Z.jsxs)(g.Z,{item:!0,xs:12,children:[(0,Z.jsx)(C.Z,{variant:"body1",dangerouslySetInnerHTML:{__html:w("SELFCONSUMPTION_ATTACHMENTS")},className:M.fieldTitle}),(0,Z.jsx)(k.Z,{maxFiles:5,fieldError:(null===A||void 0===A||null===(N=A.self_consumption)||void 0===N?void 0:N.attachments)&&(null===y||void 0===y||null===(x=y.self_consumption)||void 0===x?void 0:x.attachments)&&(null===A||void 0===A||null===(L=A.self_consumption)||void 0===L?void 0:L.attachments),callbackFn:function(e){return P("self_consumption.attachments",e)},values:(null===f||void 0===f||null===(S=f.self_consumption)||void 0===S?void 0:S.attachments)||[]})]})]})]})},ue=(0,E.Z)((function(e){return{fieldTitle:{fontWeight:500,marginBottom:e.spacing(2)},chooserQuestion:{"& h6":{marginBottom:e.spacing(0)},"& > div":{marginTop:e.spacing(2)},"& label":{paddingTop:e.spacing(1),paddingBottom:e.spacing(1),minHeight:"90px","& p":{marginTop:0}}}}})),de=l(7369),ce=(0,E.Z)((function(e){return{memberChecked:{fontWeight:500,color:e.palette.primary.main},chooserContainer:{"& h6":{fontSize:"1rem",marginTop:e.spacing(2)}}}})),_e=function(e){var n,l,i,t,o,a,r,s,u,d,c=(0,_.$)().t,v=ce(),p=e.values,h=e.handleBlur,m=e.errors,E=e.touched,T=e.setFieldValue,I=e.setFieldTouched;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(R.Z,{title:c("HOLDER_IDENTIFIER_TITLE")}),(0,Z.jsx)(C.Z,{variant:"body1",dangerouslySetInnerHTML:{__html:c("HOLDER_IDENTIFIER_DESC")}}),(0,Z.jsx)(O.Z,{mt:3,mb:3,children:(0,Z.jsx)(de.Z,{id:"vat",name:"holder.vat",label:c("VAT_LABEL"),variant:"outlined",fullWidth:!0,required:!0,autoFocus:!0,value:null===p||void 0===p||null===(n=p.holder)||void 0===n?void 0:n.vat,onChange:function(e){var n=e.vat,l=e.isPhisical,i=e.valid;T("holder.vat",n),T("holder.isphisical",l),T("holder.vatvalid",i),I("holder.vat",!0)},onBlur:h,error:(null===m||void 0===m||null===(l=m.holder)||void 0===l?void 0:l.vat)&&(null===E||void 0===E||null===(i=E.holder)||void 0===i?void 0:i.vat)||(null===E||void 0===E||null===(t=E.holder)||void 0===t?void 0:t.vat)&&!1===(null===p||void 0===p||null===(o=p.holder)||void 0===o?void 0:o.vatvalid),helperText:(null===E||void 0===E||null===(a=E.holder)||void 0===a?void 0:a.vat)&&(null===m||void 0===m||null===(r=m.holder)||void 0===r?void 0:r.vat)||(null===E||void 0===E||null===(s=E.holder)||void 0===s?void 0:s.vat)&&(null===m||void 0===m||null===(u=m.holder)||void 0===u?void 0:u.vatvalid)})}),!1!==(null===p||void 0===p||null===(d=p.contract)||void 0===d?void 0:d.has_service)&&(0,Z.jsx)(O.Z,{mt:1,mb:1,className:v.chooserContainer,children:(0,Z.jsx)(D.Z,{question:c("PREVIOUS_HOLDER"),onChange:function(e){var n=e.option;T("holder.previous_holder",n)},value:!1!==p.contract.has_service&&p.holder.previous_holder,disabled:!0!==p.holder.vatvalid||!1===p.contract.has_service,options:[{value:!0,label:c("PREVIOUS_HOLDER_YES_LABEL"),description:c("PREVIOUS_HOLDER_YES_DESC")},{value:!1,label:c("PREVIOUS_HOLDER_NO_LABEL"),description:c("PREVIOUS_HOLDER_NO_DESC")}]})})]})},ve=l(4307),pe=l(3725),he=l(9753),me=l(3433),Ee=l(8182),Te=l(7447),Oe=l(1422),Ie=l(4345),Ne=(0,E.Z)((function(e){return{withoutLabel:{marginTop:e.spacing(1)},sectionTitle:{fontSize:"18px",fontWeight:500,textTransform:"uppercase",marginTop:e.spacing(3),marginBottom:e.spacing(1.2)},field:{display:"flex",alignItems:"center",marginBottom:e.spacing(.8),"& .field__value":{flexGrow:1}},label:{textTransform:"uppercase",paddingRight:"12px",fontSize:"14px",fontWeight:400,color:"rgba(0, 0, 0, 0.54)"},subsectionTitle:{marginTop:"1rem",textTransform:"uppercase",fontSize:"14px",fontWeight:400,color:"rgba(0, 0, 0, 0.54)"},value:{fontSize:"16px"},listItem:{paddingTop:"8px"},separatedField:{flexDirection:"column",alignItems:"flex-start"},separatedValues:{marginLeft:0,marginRight:e.spacing(1.6),marginTop:e.spacing(.5),marginBottom:e.spacing(.5)},divider:{marginTop:"12px",marginLeft:0,marginRight:"32px"},dividerBottom:{marginTop:"24px",marginLeft:0,marginRight:"32px"},prices:{marginBottom:"10px",display:"flex",flexDirection:"column","& span":{paddingRight:"16px"}}}})),xe=function(e){var n,l,i,t,o,a,r,d,c,v,p,h,m,E,T,I,N,x,L,S,f,A,y,j,P,F,b,M,D,w,H,V,q,Y,k,G,Q,z=Ne(),$=(0,_.$)().t,J=e.values,ne=e.setFieldValue,le=e.isIndexedContractEnabled,ie=(0,u.useState)(!1),te=(0,s.Z)(ie,2),oe=te[0],ae=te[1],re=(0,u.useState)({}),se=(0,s.Z)(re,2),ue=se[0],de=se[1],ce=(0,u.useState)((0,U.jS)()),_e=(0,s.Z)(ce,1)[0],ve=(0,u.useState)(!0),pe=(0,s.Z)(ve,2),he=pe[0],xe=pe[1],Le=J.holder.vat===J.member.vat&&J.holder.isphisical,Se=Le?J.member:J.holder;(0,u.useEffect)((function(){xe(!0);var e=Object.values(Object.fromEntries(Object.entries(J.contract).filter((function(e){return(0,s.Z)(e,1)[0].startsWith("power")})))),n=Math.round(Math.max.apply(Math,e)*K.pe);(0,U.vD)({tariff:J.contract.rate,max_power:n,vat:Se.vat,cnae:J.supply_point.cnae,city_id:J.supply_point.city.id}).then((function(e){var n=null===e||void 0===e?void 0:e.data;de(n),xe(!1)})).catch((function(e){xe(!1),console.error(e)}))}),[]);var fe=function(e){var n=e.label,l=e.value,i=e.multipleValues,t=void 0!==i&&i;return(0,Z.jsxs)("div",{className:(0,Ee.Z)(z.field,t&&z.separatedField),children:[!1!==n&&(0,Z.jsx)("div",{className:"field__title",children:(0,Z.jsx)(C.Z,{className:z.label,variant:"subtitle2",children:n})}),(0,Z.jsx)("div",{className:(0,Ee.Z)("field__value",t&&z.separatedValues),children:(0,Z.jsx)(C.Z,{className:z.value,variant:"body2",children:l})})]})},Ae=function(){var e,n,l,i,t;return(0,Z.jsx)(g.Z,{container:!0,children:(null===(e=_e[null===J||void 0===J||null===(n=J.contract)||void 0===n?void 0:n.rate])||void 0===e?void 0:e.num_power_periods)>1?(0,me.Z)(Array(null===(l=_e[null===J||void 0===J||null===(i=J.contract)||void 0===i?void 0:i.rate])||void 0===l?void 0:l.num_power_periods)).map((function(e,n){var l,i,t=n+1===1?"power":"power".concat(n+1),o=null!==J&&void 0!==J&&null!==(l=J.contract)&&void 0!==l&&l.moreThan15Kw?"P".concat(n+1):$(0===n?"PEAK":"VALLEY");return(0,Z.jsx)(g.Z,{item:!0,xs:null!==J&&void 0!==J&&null!==(i=J.contract)&&void 0!==i&&i.moreThan15Kw?4:12,children:"".concat(o," ").concat(null===J||void 0===J?void 0:J.contract[t]," kW ")},o)})):"".concat(null===J||void 0===J||null===(t=J.contract)||void 0===t?void 0:t.power," kW")})},Ce=function(e){var n=e.concept,l=e.name,i=n?Object.keys(n):[];i.sort();var t=new Set(Object.keys(n).map((function(e){var l;return null===(l=n[e])||void 0===l?void 0:l.value})));if(1===t.size)for(var o in n){var a,r;return(0,Z.jsx)("div",{className:z.prices,children:(0,Z.jsx)("span",{children:"".concat(null===(a=n[o])||void 0===a?void 0:a.value," ").concat(null===(r=n[o])||void 0===r?void 0:r.uom)},"".concat(l))})}var s=2===i.length?[$("PEAK"),$("VALLEY")]:3===i.length?[$("PEAK"),$("FLAT"),$("VALLEY")]:i;return(0,Z.jsx)("div",{className:z.prices,children:n?i.map((function(e,i){var t,o;return(0,Z.jsx)("span",{children:"".concat(s[i],": ").concat(null===(t=n[e])||void 0===t?void 0:t.value," ").concat(null===(o=n[e])||void 0===o?void 0:o.uom)},"".concat(l,":").concat(e))})):(0,Z.jsx)(Z.Fragment,{children:$("UNAVAILABLE")})})};return he?(0,Z.jsx)(Oe.Z,{}):(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(R.Z,{title:$("REVIEW_TITLE")}),(0,Z.jsx)(C.Z,{variant:"body1",dangerouslySetInnerHTML:{__html:$("REVIEW_DESCRIPTION")}}),(0,Z.jsxs)(g.Z,{container:!0,children:[(0,Z.jsxs)(g.Z,{item:!0,xs:12,sm:6,children:[(0,Z.jsx)(C.Z,{className:z.sectionTitle,variant:"h6",children:$("SUMMARY_GROUP_PROCESS")}),(0,Z.jsx)(fe,{label:!1,value:null!==J&&void 0!==J&&null!==(n=J.contract)&&void 0!==n&&n.has_service?null!==J&&void 0!==J&&null!==(l=J.holder)&&void 0!==l&&l.previous_holder?$("CANVI_DE_COMERCIALITZADORA"):$("CANVI_DE_COMERCIALITZADORA_I_TITULAR"):$("ALTA")}),(0,Z.jsx)(fe,{label:$("RELATED_MEMBER"),value:null===J||void 0===J||null===(i=J.member)||void 0===i?void 0:i.vat})]}),(0,Z.jsxs)(g.Z,{item:!0,xs:12,sm:6,children:[(0,Z.jsx)(C.Z,{className:z.sectionTitle,variant:"h6",children:$("HOLDER")}),(0,Z.jsx)(fe,{label:"NIF",value:null===J||void 0===J||null===(t=J.holder)||void 0===t?void 0:t.vat}),null!==J&&void 0!==J&&null!==(o=J.holder)&&void 0!==o&&o.isphisical?(null===J||void 0===J||null===(a=J.holder)||void 0===a?void 0:a.name)&&(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(fe,{label:$("NAME"),value:"".concat(null===Se||void 0===Se?void 0:Se.name," ").concat(null===Se||void 0===Se?void 0:Se.surname1," ").concat(null===Se||void 0===Se?void 0:Se.surname2)})}):(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(fe,{label:$("LEGAL_NAME"),value:null===Se||void 0===Se?void 0:Se.name}),(0,Z.jsx)(fe,{label:$("PROXY"),value:"".concat(null===Se||void 0===Se?void 0:Se.proxyname," (").concat(null===Se||void 0===Se?void 0:Se.proxynif,")")})]})]}),(0,Z.jsxs)(g.Z,{item:!0,xs:12,sm:6,children:[(0,Z.jsx)(Te.Z,{variant:"middle",className:z.divider}),(0,Z.jsx)(C.Z,{className:z.sectionTitle,variant:"h6",children:$("SUPPLY")}),(0,Z.jsx)(fe,{label:$("CUPS_LABEL"),value:null===J||void 0===J||null===(r=J.supply_point)||void 0===r?void 0:r.cups}),(0,Z.jsx)(fe,{label:$("ADDRESS"),value:"".concat(null===J||void 0===J||null===(d=J.supply_point)||void 0===d?void 0:d.address,", ").concat(null===J||void 0===J||null===(c=J.supply_point)||void 0===c?void 0:c.number," ").concat(null===J||void 0===J||null===(v=J.supply_point)||void 0===v?void 0:v.floor," ").concat(null===J||void 0===J||null===(p=J.supply_point)||void 0===p?void 0:p.door)}),(0,Z.jsx)(fe,{label:$("CITY"),value:"".concat(null===J||void 0===J||null===(h=J.supply_point)||void 0===h?void 0:h.city.name," (").concat(null===J||void 0===J||null===(m=J.supply_point)||void 0===m?void 0:m.postal_code,") ").concat(null===J||void 0===J||null===(E=J.supply_point)||void 0===E?void 0:E.state.name)}),(0,Z.jsx)(fe,{label:$("CNAE"),value:null===J||void 0===J||null===(T=J.supply_point)||void 0===T?void 0:T.cnae})]}),(0,Z.jsxs)(g.Z,{item:!0,xs:12,sm:6,children:[(0,Z.jsx)(Te.Z,{variant:"middle",className:z.divider}),(0,Z.jsx)(C.Z,{className:z.sectionTitle,variant:"h6",children:$("SUMMARY_GROUP_TECHNICAL")}),!0===le?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(fe,{label:$("TOLL"),value:null!==J&&void 0!==J&&null!==(I=J.contract)&&void 0!==I&&I.has_service?$("TOLL_SAME"):null===J||void 0===J||null===(N=J.contract)||void 0===N?void 0:N.rate}),(0,Z.jsx)(fe,{label:$("FARE"),value:null!==J&&void 0!==J&&null!==(x=J.contract)&&void 0!==x&&x.isIndexed?$("FARE_INDEXED"):$("FARE_PERIODS")})]}):(0,Z.jsx)(fe,{label:$("FARE"),value:null!==J&&void 0!==J&&null!==(L=J.contract)&&void 0!==L&&L.has_service?$("FARE_SAME"):null===J||void 0===J||null===(S=J.contract)||void 0===S?void 0:S.rate}),null!==J&&void 0!==J&&null!==(f=J.contract)&&void 0!==f&&f.has_service?(0,Z.jsx)(fe,{label:$("POWER"),value:$("POWER_SAME")}):(0,Z.jsx)(fe,{label:$("POWER"),value:(0,Z.jsx)(Ae,{})}),(0,Z.jsx)(ee.Z,{className:z.withoutLabel,dangerouslySetInnerHTML:{__html:$("FARE_POWER_CHANGE_NOTE")}})]}),!0===(null===J||void 0===J||null===(A=J.self_consumption)||void 0===A?void 0:A.have_installation)&&(0,Z.jsxs)(g.Z,{item:!0,xs:12,children:[(0,Z.jsx)(Te.Z,{variant:"middle",className:z.divider}),(0,Z.jsx)(C.Z,{className:z.sectionTitle,variant:"h6",children:$("SELFCONSUMPTION_TITLE")}),(0,Z.jsxs)(g.Z,{container:!0,children:[(0,Z.jsxs)(g.Z,{item:!0,xs:12,sm:6,children:[(0,Z.jsx)(fe,{label:$("CAU"),value:null===J||void 0===J||null===(y=J.self_consumption)||void 0===y?void 0:y.cau}),(0,Z.jsx)(fe,{label:$("SELFCONSUMPTION_COLLECTIVE_INSTALLATION"),value:null!==J&&void 0!==J&&null!==(j=J.self_consumption)&&void 0!==j&&j.collective_installation?$("SELFCONSUMPTION_COLLECTIVE_INSTALLATION_LABEL"):$("SELFCONSUMPTION_INDIVIDUAL_INSTALLATION_LABEL")}),(0,Z.jsx)(fe,{label:$("SELFCONSUMPTION_INSTALLPOWER"),value:"".concat(null===J||void 0===J||null===(P=J.self_consumption)||void 0===P?void 0:P.installation_power," kW")}),(0,Z.jsx)(fe,{label:$("SELFCONSUMPTION_AUXILIARY_SERVICE"),value:null!==J&&void 0!==J&&null!==(F=J.self_consumption)&&void 0!==F&&F.aux_services?$("YES"):$("NO")})]}),(0,Z.jsxs)(g.Z,{item:!0,xs:12,sm:6,children:[(0,Z.jsx)(fe,{label:$("SELFCONSUMPTION_SITUATION"),value:$(null===J||void 0===J||null===(b=J.self_consumption)||void 0===b?void 0:b.installation_type_title)}),(0,Z.jsx)(fe,{label:$("SELFCONSUMPTION_TECHNOLOGY"),value:$(null===J||void 0===J||null===(M=J.self_consumption)||void 0===M?void 0:M.technology_title)})]})]})]}),(0,Z.jsxs)(g.Z,{item:!0,xs:12,sm:6,children:[(0,Z.jsx)(Te.Z,{variant:"middle",className:z.divider}),(0,Z.jsx)(C.Z,{className:z.sectionTitle,variant:"h6",children:$("CONTACT")}),Le?(0,Z.jsx)("div",{dangerouslySetInnerHTML:{__html:$("DATA_AS_IN_OV")}}):(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(fe,{label:$("PHONE"),value:null===Se||void 0===Se?void 0:Se.phone1}),(0,Z.jsx)(fe,{label:$("EMAIL"),value:null===Se||void 0===Se?void 0:Se.email}),(0,Z.jsx)(fe,{label:$("LANGUAGE"),value:K.Mj[null===Se||void 0===Se?void 0:Se.language]})]})]}),(0,Z.jsxs)(g.Z,{item:!0,xs:12,sm:6,children:[(0,Z.jsx)(Te.Z,{variant:"middle",className:z.divider}),(0,Z.jsx)(C.Z,{className:z.sectionTitle,variant:"h6",children:$("SUMMARY_GROUP_PAYMENT")}),(0,Z.jsx)(fe,{label:$("IBAN"),value:null===J||void 0===J||null===(D=J.payment)||void 0===D?void 0:D.iban}),(0,Z.jsx)(fe,{label:$("VOLUNTARY_CENT"),value:null!==J&&void 0!==J&&null!==(w=J.payment)&&void 0!==w&&w.voluntary_cent?$("YES"):$("NO")})]}),(0,Z.jsxs)(g.Z,{item:!0,xs:12,children:[null!==J&&void 0!==J&&null!==(H=J.contract)&&void 0!==H&&H.isIndexed?(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(Te.Z,{variant:"middle",className:z.divider}),(0,Z.jsx)(C.Z,{className:z.sectionTitle,variant:"h6",children:$("PRICES")}),(0,Z.jsx)(C.Z,{variant:"body1",align:"justify",dangerouslySetInnerHTML:{__html:$("TARIFF_MODE_INDEXED_MORE",{indexed_url:$("TARIFF_MODE_INDEXED_URL")})}})]}):(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(Te.Z,{variant:"middle",className:z.divider}),(0,Z.jsx)(C.Z,{className:z.sectionTitle,variant:"h6",children:$("PRICES_PLUS_TAXES")}),(0,Z.jsxs)(g.Z,{container:!0,children:[(0,Z.jsx)(g.Z,{item:!0,xs:12,sm:6,children:(0,Z.jsx)(fe,{label:$("TERME_ENERGIA"),value:(0,Z.jsx)(Ce,{concept:null===ue||void 0===ue?void 0:ue.te,name:"te"}),multipleValues:!0})}),(0,Z.jsx)(g.Z,{item:!0,xs:12,sm:6,children:(0,Z.jsx)(fe,{label:$("GENERATION"),value:(0,Z.jsx)(Ce,{concept:null===ue||void 0===ue?void 0:ue.gkwh,name:"gkwh"}),multipleValues:!0})}),(0,Z.jsx)(g.Z,{item:!0,xs:12,sm:6,children:(0,Z.jsx)(fe,{label:$("TERME_POTENCIA"),value:(0,Z.jsx)(Ce,{concept:null===ue||void 0===ue?void 0:ue.tp,name:"tp"}),multipleValues:!0})}),(0,Z.jsx)(g.Z,{item:!0,xs:12,sm:6,children:(0,Z.jsx)(fe,{label:$("AUTOCONSUM"),value:(0,Z.jsx)(Ce,{concept:null===ue||void 0===ue?void 0:ue.ac,name:"ac"}),multipleValues:!0})}),null!==ue&&void 0!==ue&&null!==(V=ue.bo_social)&&void 0!==V&&V.value?(0,Z.jsx)(g.Z,{item:!0,xs:12,sm:6,children:(0,Z.jsx)(fe,{label:$("BO_SOCIAL"),value:"".concat(null===ue||void 0===ue||null===(q=ue.bo_social)||void 0===q?void 0:q.value," ").concat(null===ue||void 0===ue||null===(Y=ue.bo_social)||void 0===Y?void 0:Y.uom),multipleValues:!0})}):null]})]}),null!==J&&void 0!==J&&null!==(k=J.contract)&&void 0!==k&&k.isIndexed?null:(0,Z.jsx)(C.Z,{className:z.withoutLabel,variant:"body1",align:"justify",dangerouslySetInnerHTML:{__html:$("DESCRIPTION_MAJ_ALERT")}}),(0,Z.jsx)(C.Z,{className:z.subsectionTitle,variant:"subtitle2",dangerouslySetInnerHTML:{__html:$("CONCEPTES_EXTRES")}}),(0,Z.jsxs)("ul",{children:[(0,Z.jsx)("li",{dangerouslySetInnerHTML:{__html:$("EXTRA_REACTIVA")}}),(0,Z.jsx)("li",{dangerouslySetInnerHTML:{__html:$("LLOGUER_COMPTADOR")}})]}),(0,Z.jsx)(Te.Z,{variant:"middle",className:z.dividerBottom})]})]}),(0,Z.jsx)(X.Z,{title:$("GENERAL_TERMS"),open:oe,onAccept:function(){ae(!1),ne("terms_accepted",!0)},onClose:function(){ae(!1),ne("terms_accepted",!1)},children:(0,Z.jsx)(Ie.Z,{language:null===Se||void 0===Se?void 0:Se.language,documentName:null!==J&&void 0!==J&&null!==(G=J.contract)&&void 0!==G&&G.isIndexed?"general-and-indexed-specific-terms":"general-contract-terms"})}),(0,Z.jsx)(O.Z,{mt:2,children:(0,Z.jsx)(W.Z,{control:(0,Z.jsx)(B.Z,{name:"terms_accepted",onClick:function(e){e.preventDefault(),ae(!0)},checked:J.terms_accepted,color:"primary"}),label:null!==J&&void 0!==J&&null!==(Q=J.contract)&&void 0!==Q&&Q.isIndexed?$("INDEXED_ACCEPT_CONDITIONS"):$("ACCEPT_TERMS")})}),(0,Z.jsx)(O.Z,{mt:2,children:(0,Z.jsx)(W.Z,{control:(0,Z.jsx)(B.Z,{name:"particular_terms_accepted",onClick:function(){ne("particular_contract_terms_accepted",!(null!==J&&void 0!==J&&J.particular_contract_terms_accepted))},checked:J.particular_contract_terms_accepted,color:"primary"}),label:$("CONTRACT_PARTICULAR_TERMS")})}),(0,Z.jsx)(O.Z,{mt:2,children:(0,Z.jsx)(W.Z,{control:(0,Z.jsx)(B.Z,{name:"privacy_policy_accepted",onClick:function(){ne("privacy_policy_accepted",!(null!==J&&void 0!==J&&J.privacy_policy_accepted))},checked:J.privacy_policy_accepted,color:"primary"}),label:(0,Z.jsx)(C.Z,{variant:"body1",align:"justify",dangerouslySetInnerHTML:{__html:$("CONTRACT_PRIVACY_POLICY_TERMS",{url:$("CONTRACT_PRIVACY_POLICY_TERMS_URL")})}})})})]})},Le=l(8545),Se=l(7188),fe=null===(i=window)||void 0===i||null===(t=i.config)||void 0===t?void 0:t.GA_TRAKING_ID,Ae={SAMPLE_DATA:"ctrl+shift+1",SHOW_INSPECTOR:"ctrl+alt+shift+d",SHOW_ALL_STEPS:"ctrl+alt+shift+a"},Ce=(0,E.Z)((function(e){return{root:{position:"relative",color:e.palette.text.primary},stepContainer:{marginTop:0,marginBottom:e.spacing(4),width:"100%",display:"flex",flexDirection:"column",backgroundColor:e.palette.backgroundColor},step:{position:"absolute",width:"100%"},actionsContainer:{display:"flex",justifyContent:"space-between"}}})),Re=function(e){var n=Ce(),l=(0,_.$)(),i=l.t,t=l.i18n,E=(0,m.UO)().language,C=e.is30ContractEnabled,R=void 0===C||C,y=e.isIndexedContractEnabled,j=void 0!==y&&y,g=e.isCadastralReference,F=void 0!==g&&g,b=(0,u.useState)(!1),M=(0,s.Z)(b,2),D=M[0],w=M[1],H=(0,u.useState)(!1),B=(0,s.Z)(H,2),W=B[0],q=B[1],Y=(0,u.useState)(0),X=(0,s.Z)(Y,2),k=X[0],G=X[1],Q=(0,u.useState)(!1),z=(0,s.Z)(Q,2),$=z[0],ee=z[1],ne=(0,u.useState)(!1),ie=(0,s.Z)(ne,2),ae=ie[0],re=ie[1],ue=(0,u.useState)(!1),de=(0,s.Z)(ue,2),ce=de[0],me=de[1],Ee=(0,u.useState)({}),Te=(0,s.Z)(Ee,2),Oe=Te[0],Ie=Te[1],Ne=(0,u.useState)((0,U.jS)()),Re=(0,s.Z)(Ne,1)[0];(0,u.useEffect)((function(){t.changeLanguage(E)}),[E,t]);var ye={SAMPLE_DATA:function(){(0,r.Z)({},Fe)},SHOW_INSPECTOR:function(){w((function(e){return!e}))},SHOW_ALL_STEPS:function(){q((function(e){return!e}))}},je=[h.Ry().shape({member:h.Ry().shape({number:h.Z_().required(i("NO_MEMBER_NUMBER")),vat:h.Z_().required(i("NO_MEMBER_VAT")),checked:h.Xg().required(i("NO_MEMBER_MATCH")).oneOf([!0],i("NO_MEMBER_MATCH"))})}),h.Ry().shape({supply_point:h.Ry().shape({cups:h.Z_().required(i("CUPS_INVALID")).min(18,i("CUPS_INVALID")).test("statusError",i("CUPS_INVALID"),(function(){return!("error"===this.parent.status)})).test("statusError",i("CUPS_IN_PROCESS"),(function(){return!("busy"===this.parent.status)})).test("statusNew",i("CUPS_IS_ACTIVE"),(function(){return!("active"===this.parent.status)})).test("statusInvalid",i("INVALID_SUPPLY_POINT_CUPS"),(function(){return!("invalid"===this.parent.status)}))}),contract:h.Ry().shape({has_service:h.Xg().required(i("UNSELECTED_NEW_SUPPLY_POINT")).oneOf([!0,!1],i("UNSELECTED_NEW_SUPPLY_POINT"))})}),h.Ry().shape({supply_point:h.Ry().shape({address:h.Z_().required(i("NO_ADDRESS")),number:h.Z_().required(i("NO_NUMBER")),postal_code:h.Z_().matches(/^\d*$/,i("NO_POSTALCODE")).required(i("NO_POSTALCODE")).min(5,i("NO_POSTALCODE")).max(5,i("NO_POSTALCODE")),state:h.Ry().shape({id:h.Rx().required(i("NO_STATE"))}),city:h.Ry().shape({id:h.Rx().required(i("NO_CITY"))}),is_housing:h.Xg().oneOf([!0,!1],i("NO_IS_HOUSING")).test("CnaeNoHousing",i("INVALID_CNAE_NO_HOUSING"),(function(){return!(!1===this.parent.is_housing&&this.parent.cnae===K.C2)})),cnae:h.Z_().required(i("INVALID_SUPPLY_POINT_CNAE")).min(3,i("INVALID_SUPPLY_POINT_CNAE")).test("CnaeNoHousing",i("INVALID_CNAE_NO_HOUSING"),(function(){return!(!1===this.parent.is_housing&&this.parent.cnae===K.C2)})),cnae_valid:h.Xg().required(i("INVALID_SUPPLY_POINT_CNAE")).oneOf([!0],i("INVALID_SUPPLY_POINT_CNAE")),supply_point_accepted:h.Xg().required(i("CUPS_VERIFY_LABEL")).oneOf([!0],i("CUPS_VERIFY_LABEL")),cadastral_reference:h.Z_().when("cadastral_reference_error",(function(e){return e?h.Z_().test({name:"cadastral_reference_error",test:function(){return!1},message:e}):h.Z_(i("INVALID_REF_CADASTRAL_LENGTH"))})),cadastral_reference_error:h.Z_().notRequired()},[["cadastral_reference","cadastral_reference"]])}),h.Ry().shape({contract:h.Ry().shape({phases:h.Z_().when("has_service",{is:!1,then:h.Z_().required(i("NO_MONOPHASE_CHOICE"))}),rate:h.Z_().when("has_service",{is:!0,then:h.Z_().required(i("NO_FARE_CHOSEN"))}),moreThan15Kw:h.O7().required(),power:h.Rx().required(i("NO_POWER_CHOSEN_PX")).test({name:"minPowerValue",test:function(){return(0,K.FT)(Re,this.parent,"min_power",this.createError,i)}}).test({name:"maxPowerValue",test:function(){return(0,K.FT)(Re,this.parent,"max_power",this.createError,i)}}),power2:h.Rx().test("required",i("NO_POWER_CHOSEN_PX"),(function(){var e;return!((null===(e=Re[this.parent.rate])||void 0===e?void 0:e.num_power_periods)>=2)||this.parent.power2})).test("increasing",i("NO_POWER_INCREASING"),(function(){var e;return null===(e=Re[this.parent.rate])||void 0===e||!e.increasing||parseFloat(this.parent.power2)>=parseFloat(this.parent.power)})).test({name:"minPowerValue",test:function(){return(0,K.FT)(Re,this.parent,"min_power",this.createError,i)}}).test({name:"maxPowerValue",test:function(){return(0,K.FT)(Re,this.parent,"max_power",this.createError,i)}}),power3:h.Rx().test("required",i("NO_POWER_CHOSEN_PX"),(function(){var e;return!((null===(e=Re[this.parent.rate])||void 0===e?void 0:e.num_power_periods)>=3)||this.parent.power3})).test("increasing",i("NO_POWER_INCREASING"),(function(){var e;return null===(e=Re[this.parent.rate])||void 0===e||!e.increasing||parseFloat(this.parent.power3)>=parseFloat(this.parent.power2)})).test({name:"minPowerValue",test:function(){return(0,K.FT)(Re,this.parent,"min_power",this.createError,i)}}).test({name:"maxPowerValue",test:function(){return(0,K.FT)(Re,this.parent,"max_power",this.createError,i)}}),power4:h.Rx().test("required",i("NO_POWER_CHOSEN_PX"),(function(){var e;return!((null===(e=Re[this.parent.rate])||void 0===e?void 0:e.num_power_periods)>=4)||this.parent.power4})).test("increasing",i("NO_POWER_INCREASING"),(function(){var e;return null===(e=Re[this.parent.rate])||void 0===e||!e.increasing||parseFloat(this.parent.power4)>=parseFloat(this.parent.power3)})).test({name:"minPowerValue",test:function(){return(0,K.FT)(Re,this.parent,"min_power",this.createError,i)}}).test({name:"maxPowerValue",test:function(){return(0,K.FT)(Re,this.parent,"max_power",this.createError,i)}}),power5:h.Rx().test("required",i("NO_POWER_CHOSEN_PX"),(function(){var e;return!((null===(e=Re[this.parent.rate])||void 0===e?void 0:e.num_power_periods)>=5)||this.parent.power5})).test("increasing",i("NO_POWER_INCREASING"),(function(){var e;return null===(e=Re[this.parent.rate])||void 0===e||!e.increasing||parseFloat(this.parent.power5)>=parseFloat(this.parent.power4)})).test({name:"minPowerValue",test:function(){return(0,K.FT)(Re,this.parent,"min_power",this.createError,i)}}).test({name:"maxPowerValue",test:function(){return(0,K.FT)(Re,this.parent,"max_power",this.createError,i)}}),power6:h.Rx().test("required",i("NO_POWER_CHOSEN_PX"),(function(){var e;return!((null===(e=Re[this.parent.rate])||void 0===e?void 0:e.num_power_periods)>=6)||this.parent.power6})).test("increasing",i("NO_POWER_INCREASING"),(function(){var e;return null===(e=Re[this.parent.rate])||void 0===e||!e.increasing||parseFloat(this.parent.power6)>=parseFloat(this.parent.power5)})).test({name:"minPowerValue",test:function(){return(0,K.FT)(Re,this.parent,"min_power",this.createError,i)}}).test({name:"maxPowerValue",test:function(){return(0,K.FT)(Re,this.parent,"max_power",this.createError,i)}})})}),h.Ry().shape({contract:h.Ry().shape({isIndexed:h.Xg().required()})}),h.Ry().shape({self_consumption:h.Ry().shape({have_installation:h.Xg().required(i("FILL_SELFCONSUMPTION_QUESTION"))})}),h.Ry().shape({self_consumption:h.Ry().shape({cau:h.Z_().when("cau_error",(function(e){return e?h.nK().test({name:"cau_error",test:function(){return!1},message:e}):h.Z_().required(i("FILL_SELFCONSUMPTION_CAU"))})),cau_error:h.nK().oneOf([h.Xg(),h.Z_()]),collective_installation:h.Xg().required(i("FILL_SELFCONSUMPTION_COLLECTIVE_INSTALLATION")),installation_power:h.Rx().required(i("FILL_SELFCONSUMPTION_INSTALLATION_POWER")),installation_type:h.Z_().required(i("FILL_SELFCONSUMPTION_INSTALLATION_SITUATION")),technology:h.Z_().required(i("FILL_SELFCONSUMPTION_TECHNOLOGY")),aux_services:h.Xg().required(i("FILL_SELFCONSUMPTION_AUX_SERVICES"))})}),h.Ry().shape({holder:h.Ry().shape({previous_holder:h.Xg().required(i("FILL_PREVIOUS_HOLDER")).oneOf([!0,!1],i("FILL_PREVIOUS_HOLDER")),vat:h.Z_().required(i("FILL_NIF")),vatvalid:h.Xg().required(i("FILL_NIF")).oneOf([!0],i("FILL_NIF"))})}),h.Ry().shape({holder:h.Ry().shape({name:h.Z_().required(i("NO_NAME")),surname1:h.Z_().when("isphisical",{is:!0,then:h.Z_().required(i("NO_SURNAME1"))}),proxyname:h.Z_().when("isphisical",{is:!1,then:h.Z_().required(i("NO_PROXY_NAME"))}),proxynif:h.Z_().when("isphisical",{is:!1,then:h.Z_().required(i("NO_PROXY_NIF"))}),proxynif_valid:h.Xg().when("isphisical",{is:!1,then:h.Xg().required(i("FILL_NIF")).oneOf([!0],i("FILL_NIF"))}),address:h.Z_().required(i("NO_ADDRESS")),postal_code:h.Z_().matches(/^\d*$/,i("NO_POSTALCODE")).required(i("NO_POSTALCODE")).min(5,i("NO_POSTALCODE")).max(5,i("NO_POSTALCODE")),state:h.Ry().shape({id:h.Rx().required(i("NO_STATE"))}),city:h.Ry().shape({id:h.Rx().required(i("NO_CITY"))}),email:h.Z_().required(i("NO_EMAIL")).email(i("NO_EMAIL")),email2:h.Z_().required(i("NO_EMAIL")).test("repeatEmail",i("NO_REPEATED_EMAIL"),(function(){return this.parent.email===this.parent.email2})),phone1:h.Z_().min(9,i("NO_PHONE")).required(i("NO_PHONE")),phone2:h.Z_().min(9,i("NO_PHONE")),language:h.Z_().required(i("NO_LANGUAGE"))}),legal_person_accepted:h.Xg().test({name:"isTheMemberVat",message:i("ACCEPT_LEGAL_PERSON"),test:function(){return!(!1===this.parent.holder.isphisical&&!0!==this.parent.legal_person_accepted)}})}),h.Ry().shape({payment:h.Ry().shape({voluntary_cent:h.Xg().required(i("NO_VOLUNTARY_DONATION_CHOICE_TAKEN")).oneOf([!1,!0],i("NO_VOLUNTARY_DONATION_CHOICE_TAKEN"))})}),h.Ry().shape({payment:h.Ry().shape({iban:h.Z_().required(i("IBAN_ERROR")),iban_valid:h.Xg().required(i("IBAN_ERROR")).oneOf([!0],i("IBAN_ERROR")),sepa_accepted:h.Xg().required(i("IBAN_ERROR")).oneOf([!0],i("IBAN_ERROR"))})}),h.Ry().shape({terms_accepted:h.Xg().required(i("UNACCEPTED_TERMS")).oneOf([!0],i("UNACCEPTED_TERMS")),particular_contract_terms_accepted:h.Xg().required(i("UNACCEPTED_TERMS")).oneOf([!0],i("UNACCEPTED_TERMS")),privacy_policy_accepted:h.Xg().required(i("UNACCEPTED_PRIVACY_POLICY")).oneOf([!0],i("UNACCEPTED_PRIVACY_POLICY"))})],Ze=[(0,Z.jsx)(P,{}),(0,Z.jsx)(V,{}),(0,Z.jsx)(J,{}),(0,Z.jsx)(le,{}),(0,Z.jsx)(te,{}),(0,Z.jsx)(oe,{}),(0,Z.jsx)(se,{}),(0,Z.jsx)(_e,{}),(0,Z.jsx)(ve.Z,{}),(0,Z.jsx)(pe.Z,{}),(0,Z.jsx)(he.Z,{}),(0,Z.jsx)(xe,{})],Pe=Ze.length,ge=function(e){var n=i("DATA_PROTECTION_CONTRACT_URL");return(0,Z.jsxs)(Z.Fragment,{children:[(W||0===k)&&(0,Z.jsx)(P,(0,r.Z)((0,r.Z)({},e),{},{is30ContractEnabled:R})),(W||1===k)&&(0,Z.jsx)(V,(0,r.Z)({},e)),(W||2===k)&&(0,Z.jsx)(J,(0,r.Z)((0,r.Z)({},e),{},{isCadastralReference:F})),(W||3===k)&&(0,Z.jsx)(le,(0,r.Z)({rates:Re,isIndexedContractEnabled:j,is30ContractEnabled:R},e)),(W||4===k)&&(0,Z.jsx)(te,(0,r.Z)({},e)),(W||5===k)&&(0,Z.jsx)(oe,(0,r.Z)({},e)),(W||6===k)&&(0,Z.jsx)(se,(0,r.Z)({},e)),(W||7===k)&&(0,Z.jsx)(_e,(0,r.Z)({},e)),(W||8===k)&&(0,Z.jsx)(ve.Z,(0,r.Z)({skipPrivacyPolicy:!0,url:n},e)),(W||9===k)&&(0,Z.jsx)(pe.Z,(0,r.Z)({},e)),(W||10===k)&&(0,Z.jsx)(he.Z,(0,r.Z)({},e)),(W||11===k)&&(0,Z.jsx)(xe,(0,r.Z)({isIndexedContractEnabled:j},e))]})},Fe={holder:{vat:"",vatvalid:!1,previous_holder:"",isphisical:!0,proxynif_valid:!1,proxynif:"",proxyname:"",name:"",address:"",number:"",floor:"",door:"",postal_code:"",state:{id:""},city:{id:""},surname1:"",surname2:"",email:"",email2:"",phone1:"",phone2:"",language:"".concat(t.language,"_ES")},supply_point:{cups:"",status:!1,address:"",number:"",floor:"",door:"",postal_code:"",state:{id:""},city:{id:""},is_housing:"",cnae:"",cnae_valid:!1,cadastral_reference:"",cadastral_reference_error:void 0,attachments:[],supply_point_accepted:!1},self_consumption:{have_installation:""},contract:{has_service:"",rate:"",power:"",power2:"",power3:"",phases:"",fare:"",moreThan15Kw:!1,isIndexed:!1},member:{number:"",vat:"",full_name:"",checked:!1,proxynif:"",proxyname:"",name:"",address:"",postal_code:"",state:{id:""},city:{id:""},surname1:"",surname2:"",email:"",email2:"",phone1:"",phone2:"",language:"".concat(t.language,"_ES")},payment:{iban:"",sepa_accepted:!1,voluntary_cent:""},privacy_policy_accepted:!1,terms_accepted:!1,particular_contract_terms_accepted:!1,legal_person_accepted:!1},be=(0,c.Z)({domain:"",apiHost:""}),Me=function(){var e=(0,a.Z)((0,o.Z)().mark((function e(n){var l;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ee(!0),l=(0,K.$o)(n),e.next=4,(0,U.LJ)(l).then((function(e){var n;!0===(null===e||void 0===e?void 0:e.state)?(me(!1),Ie({contract_number:null===e||void 0===e||null===(n=e.data)||void 0===n?void 0:n.contract_number}),be.trackPageview({url:window.location.protocol+"//"+window.location.hostname+"/es/contratacion-realizada/"}),d.ZP.initialize(fe),d.ZP.pageview("/es/contratacion-realizada/")):me(!0)})).catch((function(e){var n,l,i,t;console.error(e);var o=null!==e&&void 0!==e&&null!==(n=e.response)&&void 0!==n&&null!==(l=n.data)&&void 0!==l&&l.error?null===e||void 0===e||null===(i=e.response)||void 0===i||null===(t=i.data)||void 0===t?void 0:t.error:{code:"UNEXPECTED"};me(o)}));case 4:ee(!1),G(Pe),re(!0);case 7:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}();return(0,Z.jsx)(v.GlobalHotKeys,{handlers:ye,keyMap:Ae,children:(0,Z.jsx)(N.Z,{maxWidth:"md",disableGutters:!0,children:(0,Z.jsx)(p.J9,{onSubmit:function(){},enableReinitialize:!0,initialValues:Fe,validationSchema:je[k],validateOnMount:!0,children:function(e){return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)("div",{children:(0,Z.jsx)(p.l0,{className:n.root,noValidate:!0,autoComplete:"off",children:(0,Z.jsxs)(x.Z,{elevation:0,className:n.stepContainer,children:[false,(0,Z.jsx)(O.Z,{mx:0,mb:3,children:ae?ce?(0,Z.jsx)(Se.default,{error:ce}):(0,Z.jsx)(Le.default,{result:Oe}):ge(e)}),(0,Z.jsx)(O.Z,{mx:0,mt:1,mb:3,children:(0,Z.jsxs)("div",{className:n.actionsContainer,children:[void 0===(null===Oe||void 0===Oe?void 0:Oe.contract_number)&&(0,Z.jsx)(T.Z,{"data-cy":"prev",className:n.button,startIcon:(0,Z.jsx)(f.Z,{}),disabled:0===k||$,onClick:function(){return function(e){var n=k-1;8===n&&e.values.holder.vat===e.values.member.vat&&e.values.holder.isphisical&&n--,6!==n||e.values.self_consumption.have_installation||n--,5!==n||e.values.contract.has_service||n--,4!==n||j||n--,G(Math.max(0,n)),ae&&(re(!1),me(!1)),e.submitForm().then((function(){e.validateForm(),e.setTouched({})}))}(e)},children:i("PAS_ANTERIOR")}),k<Pe-1?(0,Z.jsx)(T.Z,{type:"button","data-cy":"next",className:n.button,variant:"contained",color:"primary",endIcon:(0,Z.jsx)(S.Z,{}),disabled:!e.isValid,onClick:function(){return function(e){var n=k+1;4!==n||j||n++,5!==n||e.values.contract.has_service||n++,6!==n||e.values.self_consumption.have_installation||n++,8===n&&e.values.holder.vat===e.values.member.vat&&e.values.holder.isphisical&&n++;var l=Pe;e.submitForm().then((function(){e.isValid&&(G(Math.min(n,l)),e.validateForm(),e.setTouched({}))}))}(e)},children:i("SEGUENT_PAS")}):!ae&&(0,Z.jsx)(T.Z,{type:"button","data-cy":"submit",className:n.button,variant:"contained",color:"primary",startIcon:$?(0,Z.jsx)(I.Z,{size:24}):(0,Z.jsx)(A.Z,{}),disabled:$||!e.isValid,onClick:function(){return Me(e.values)},children:i("SEND")})]})})]})})}),D&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(T.Z,{variant:"outlined",size:"small",onClick:function(){return q(!W)},children:"Show all steps"}),(0,Z.jsx)(L.Z,(0,r.Z)({},e))]})]})}})})})}}}]);
//# sourceMappingURL=513.d13b0ea6.chunk.js.map